<metro:MetroWindow
    x:Class="WLS3200Gen2.MainWindow"
    xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
    xmlns:materialDesign="http://materialdesigninxaml.net/winfx/xaml/themes"
    xmlns:metro="http://metro.mahapps.com/winfx/xaml/controls"
    xmlns:d="http://schemas.microsoft.com/expression/blend/2008"
    xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
    xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006"
    xmlns:logger="clr-namespace:YuanliCore.Logger;assembly=YuanliCore.Model"
    xmlns:views="clr-namespace:YuanliCore.Views;assembly=YuanliCore.Model"
    xmlns:viewsNew="clr-namespace:WLS3200Gen2.Views"
    xmlns:UserControlUC="clr-namespace:WLS3200Gen2.UserControls"        
    xmlns:i="http://schemas.microsoft.com/expression/2010/interactivity" 

    xmlns:command="http://www.galasoft.ch/mvvmlight" 
    xmlns:motion="clr-namespace:YuanliCore.Motion;assembly=YuanliCore.Model" 
    xmlns:microscope="clr-namespace:YuanliCore.Model.Microscope;assembly=YuanliCore.Model" 
    xmlns:account="clr-namespace:YuanliCore.Account;assembly=YuanliCore.Model"    
    xmlns:usercontrols="clr-namespace:YuanliCore.Model.UserControls;assembly=YuanliCore.Model" xmlns:usercontrols1="clr-namespace:YuanliCore.Model.UserControls" xmlns:wls3200gen2="clr-namespace:WLS3200Gen2" xmlns:views1="clr-namespace:WLS3200Gen2.Views"
    mc:Ignorable="d"
        Title="{Binding Version}"   Height="1080" Width="1920"
        DataContext="{Binding Main, Source={StaticResource Locator}}"   
        Background="GhostWhite"     
        Icon= "YuanLi.ico" 
        WindowState="Maximized"  ResizeMode="NoResize" IsHitTestVisible="True"  
        ShowIconOnTitleBar="True"   ShowCloseButton="True" ShowMinButton="False" ShowMaxRestoreButton="False"  

     PreviewMouseDown="Window_PreviewMouseDown">

    <i:Interaction.Triggers>
        <i:EventTrigger EventName="Closing">
            <command:EventToCommand Command="{Binding WindowClosingCommand}" PassEventArgsToCommand="True"  />
        </i:EventTrigger>
        <i:EventTrigger EventName="Loaded">
            <i:InvokeCommandAction  Command="{Binding WindowLoadedCommand}"  />
        </i:EventTrigger>
    </i:Interaction.Triggers>

    <Grid  Background="White">
        <Grid.RowDefinitions>

        </Grid.RowDefinitions>

        <Grid.Resources>
            <ResourceDictionary>
                <wls3200gen2:IsLoadPortEnableConver  x:Key="CvrIsLoadPortEnable" />
                <Style TargetType="{x:Type Border}" x:Key="HorizontalDividerBorder">
                    <Setter Property="Background" Value="{DynamicResource MaterialDesignDivider}"/>
                    <Setter Property="UseLayoutRounding" Value="True"/>
                    <Setter Property="HorizontalAlignment" Value="Stretch"/>
                    <Setter Property="Height" Value="1"/>
                </Style>

            </ResourceDictionary>
        </Grid.Resources>



        <!--<TabControl materialDesign:ColorZoneAssist.Mode="PrimaryMid"   Style="{StaticResource MaterialDesignNavigationRailTabControl}" TabStripPlacement="Top">-->


        <TabControl  VerticalContentAlignment="Top"
                     materialDesign:ColorZoneAssist.Mode="Standard" materialDesign:ElevationAssist.Elevation="Dp4"  
                     TabStripPlacement="Left"   
                     Grid.ColumnSpan="7" >
            <!--Style="{StaticResource MaterialDesignNavigationRailTabControl}"-->

            <TabControl.Resources>

                <Style x:Key="YourTabItemStyle" TargetType="TabItem">
                    <Setter Property="Template">
                        <Setter.Value>
                            <ControlTemplate TargetType="TabItem">
                                <Border Name="Border" BorderThickness="1,1,1,0" BorderBrush="Black" Background="{TemplateBinding Background}">
                                    <ContentPresenter x:Name="ContentSite" VerticalAlignment="Center" HorizontalAlignment="Center" ContentSource="Header" RecognizesAccessKey="True">
                                        <!--<ContentPresenter.Resources>
                                                        <Style TargetType="TextBlock">
                                                            <Setter Property="FontSize" Value="6"/>
                                                        </Style>
                                                    </ContentPresenter.Resources>-->
                                    </ContentPresenter>
                                </Border>
                                <ControlTemplate.Triggers>
                                    <Trigger Property="IsSelected" Value="True">
                                        <Setter TargetName="Border" Property="BorderBrush" Value="Transparent"/>
                                    </Trigger>
                                    <Trigger Property="IsMouseOver" Value="True">
                                        <Setter TargetName="Border" Property="Background" Value="#F0F0F0"/>
                                    </Trigger>
                                </ControlTemplate.Triggers>
                            </ControlTemplate>
                        </Setter.Value>
                    </Setter>
                </Style>

            </TabControl.Resources>
            <!--首頁-->
            <TabItem Height="75" IsSelected="{Binding IsMainHomePageSelect}" >
                <TabItem.Header >

                    <StackPanel Width="auto"  Height="auto">
                        <materialDesign:PackIcon   Width="34" Height="34" HorizontalAlignment="Center" Kind="HomeVariant" />
                        <TextBlock HorizontalAlignment="Center" Text="Home" />
                    </StackPanel>
                </TabItem.Header>
                <Grid>
                    <Grid.ColumnDefinitions>
                        <ColumnDefinition/>
                        <ColumnDefinition />
                    </Grid.ColumnDefinitions>
                    <Grid Grid.Column="0">
                        <Grid.RowDefinitions>
                            <RowDefinition  />
                            <RowDefinition Height="0.3*" />
                        </Grid.RowDefinitions>

                        <TabControl   materialDesign:ColorZoneAssist.Background="{DynamicResource MaterialDesignCardBackground}"
                                    materialDesign:ColorZoneAssist.Foreground="{DynamicResource PrimaryHueMidBrush}"  
                                    materialDesign:ColorZoneAssist.Mode="Custom" Grid.Row="0"
                                    Style="{StaticResource MaterialDesignFilledTabControl}">
                            <TabItem Header="Micro">
                                <views:VirtualCanvas Grid.Row="1" Width="910" Height="760"  ImageSource="{Binding MainImage}" />
                            </TabItem>
                            <TabItem Header="Macro">
                                <views:VirtualCanvas Grid.Row="1" Width="910" Height="760" />
                            </TabItem>
                            <TabItem Header="TAB 3" Visibility="Hidden">


                            </TabItem>
                            <views:VirtualCanvas Height="760" />
                            <Grid/>
                        </TabControl>

                        <logger:LoggerUC  Grid.Row="1"  Message="{Binding LogMessage}" />
                    </Grid>
                    <Grid  Grid.Column="1">


                        <Grid.RowDefinitions>
                            <RowDefinition Height="0.09*"/>
                            <RowDefinition Height="0.63*"/>
                            <RowDefinition Height="0.30*"/>
                        </Grid.RowDefinitions>
                        <Grid  IsEnabled="{Binding IsOperateUI}"  >
                            <Grid.ColumnDefinitions>
                                <ColumnDefinition Width="5*"/>
                                <ColumnDefinition Width="1.0*"/>
                                <ColumnDefinition Width="1.0*"/>
                                <ColumnDefinition Width="1.0*"/>
                                <ColumnDefinition Width="0.5*"/>
                                <ColumnDefinition Width="3*"/>
                            </Grid.ColumnDefinitions>
                            <Border Grid.Column="0" Margin="1"  BorderBrush="DeepSkyBlue" BorderThickness="2">
                                <Grid Grid.Column="0">
                                    <Grid.ColumnDefinitions>
                                        <ColumnDefinition />
                                        <ColumnDefinition/>

                                        <ColumnDefinition  Width="2*" />
                                    </Grid.ColumnDefinitions>
                                    <GroupBox Header="Recipe Name:" FontSize="18" Grid.Column="2"   BorderBrush="Black"  BorderThickness="1" >
                                        <TextBlock  Text="{Binding RecipeName}" Height="30" VerticalAlignment="Center" FontSize="24"  Grid.Column="3"/>
                                    </GroupBox>

                                    <Button  Command="{Binding ReadRecipeCommand}" Margin="5,0,5,0" Height="60"  ToolTip="Load"  Grid.Column="0" BorderThickness="0"  Background="#FF6D879E"  >
                                        <materialDesign:PackIcon Kind="FileDocumentArrowRight" Height="50" Width="60" />
                                    </Button>
                                    <Button   Command="{Binding SaveRecipeCommand}" Margin="5,0,5,0" Height="60"  ToolTip="Save" Grid.Column="1" BorderThickness="0" Background="#FF6D879E"  >
                                        <materialDesign:PackIcon Kind="ContentSave" Height="50" Width="60"  />
                                    </Button>
                                </Grid>
                            </Border>
                            <Border Grid.Column="1" Grid.ColumnSpan="4"   BorderBrush="DeepSkyBlue"  BorderThickness="2"/>
                            <Button Grid.Column="1" Width="70" Height="70"
                                  materialDesign:ButtonProgressAssist.IsIndeterminate="{Binding IsRunning}"
                                  materialDesign:ButtonProgressAssist.IsIndicatorVisible="True"
                                  materialDesign:ButtonProgressAssist.Value="-1"
                                   Visibility="{Binding ProcessVisibility}" 
                                  Command="{Binding RunCommand}"
                                  IsEnabled="{Binding DataContext.ControlsEnabled, RelativeSource={RelativeSource FindAncestor, AncestorType=Window}}"
                                  Style="{StaticResource MaterialDesignFloatingActionButton}">
                                <materialDesign:PackIcon  Width="60" Height="60" Kind="Play" />
                            </Button>

                            <!--<Button Grid.Column="1"
                                  materialDesign:ButtonProgressAssist.IsIndeterminate="{Binding IsRunning}"
                                  materialDesign:ButtonProgressAssist.IsIndicatorVisible="True"
                                  materialDesign:ButtonProgressAssist.Value="-1"
                                
                                  Command="{Binding ResumeCommand}"
                                  IsEnabled="{Binding DataContext.ControlsEnabled, RelativeSource={RelativeSource FindAncestor, AncestorType=Window}}"
                                  Style="{StaticResource MaterialDesignFloatingActionButton}">
                                <materialDesign:PackIcon  Width="40" Height="40" Kind="Play" />
                            </Button>-->



                            <Button Grid.Column="2" Width="70" Height="70"
                                  IsEnabled="{Binding DataContext.ControlsEnabled, RelativeSource={RelativeSource FindAncestor, AncestorType=Window}}"
                                  Style="{StaticResource MaterialDesignFloatingActionButton}"
                                 Command="{Binding PauseCommand}"
                                  ToolTip="MaterialDesignFloatingActionButton" Cursor="Hand">
                                <materialDesign:PackIcon  Width="50" Height="50" Kind="Pause" />
                            </Button>

                            <Button Grid.Column="3" Width="70" Height="70"
                                  Command="{Binding StopCommand}"
                                  IsEnabled="{Binding DataContext.ControlsEnabled, RelativeSource={RelativeSource FindAncestor, AncestorType=Window}}"
                                  Style="{StaticResource MaterialDesignFloatingActionButton}"
                                  ToolTip="MaterialDesignFloatingActionButton">
                                <materialDesign:PackIcon  Width="60" Height="60" Kind="Stop" />
                            </Button>

                            <UserControlUC:ProcessMenuUC Grid.Column="4" IsAutoSave="{Binding IsAutoSave}" IsDieAllPhoto="{Binding IsDieAllPhoto}" IsWaferCirclePhoto="{Binding IsWaferCirclePhoto}" IsTestRun="{Binding IsTestRun}"/>
                            <Border Grid.Column="5"    BorderBrush="DeepSkyBlue"  BorderThickness="2">
                                <UserControlUC:MachineStateUC Status="{Binding Machinestatus}"/>
                            </Border>


                        </Grid>
                        <Grid Grid.Row="1" Margin="0">
                            <Grid.ColumnDefinitions >
                                <ColumnDefinition Width="0.67*"/>
                                <ColumnDefinition Width="0.33*"/>
                            </Grid.ColumnDefinitions>
                            <views:VirtualCanvas Margin="0,0,-2,-2" Grid.Row="0" IsShowBar="True"  ImageSource="{Binding HomeMapImage}" ItemsSource="{Binding HomeMapDrawings}"   
                                                                              AddShapeAction="{Binding AddHomeMapShapeAction}" ClearShapeAction="{Binding ClearHomeMapShapeAction}" RemoveShapeAction="{Binding RemoveHomeMapShapeAction}"  >

                            </views:VirtualCanvas>
                            <GroupBox Grid.Column="1"  >
                                <GroupBox.Header>
                                    <StackPanel Orientation="Horizontal">
                                        <Label  Content="Load Port"  />
                                    </StackPanel>

                                </GroupBox.Header>
                                <Grid >
                                    <Grid Margin="-5">
                                        <Grid.RowDefinitions>
                                            <RowDefinition Height="0.1*" />
                                            <RowDefinition Height="0.1*" />
                                            <RowDefinition />
                                        </Grid.RowDefinitions>
                                        <Grid.ColumnDefinitions>
                                            <ColumnDefinition />
                                            <ColumnDefinition />

                                        </Grid.ColumnDefinitions>
                                        <RadioButton Grid.Column="0"  Height="40" Width="100" Content="Load port1"  GroupName="GroupChoiceChipOutline" IsChecked="{Binding IsLoadport1}" Style="{StaticResource MaterialDesignChoiceChipPrimaryOutlineRadioButton}" />
                                        <RadioButton Grid.Column="1"  Height="40" Width="100" Content="Load port2" GroupName="GroupChoiceChipOutline" IsChecked="{Binding IsLoadport2}"  Style="{StaticResource MaterialDesignChoiceChipPrimaryOutlineRadioButton}" IsEnabled="{Binding LoadportQuantity, Converter={StaticResource CvrIsLoadPortEnable}}"  />
                                        <Button Grid.Row="1" Content="Scan" Command="{Binding SlotMappingCommand}" />
                                        <UserControlUC:ProcessCassetteMenuUC  Grid.Column="0" Grid.ColumnSpan="2"  Grid.Row="2" ProcessStation="{Binding ProcessStations}"/>

                                    </Grid>
                                </Grid>

                            </GroupBox>
                        </Grid>


                        <TabControl Margin="1" Grid.Row="2"    SelectedIndex="{Binding TabControlSelectedIndex}"  >
                            <TabItem Header="Information"  Visibility="{Binding InformationUCVisibility}" Height="10">
                                <GroupBox Grid.Column="0" Grid.Row="0" Header="Process Infomation" FontSize="15">
                                    <Grid Margin="-4">
                                        <Grid.ColumnDefinitions>
                                            <ColumnDefinition/>
                                            <ColumnDefinition/>
                                        </Grid.ColumnDefinitions>
                                        <Grid>
                                            <Grid.RowDefinitions>
                                                <RowDefinition />
                                                <RowDefinition />
                                                <RowDefinition />
                                                <RowDefinition />
                                                <RowDefinition />
                                                <RowDefinition />
                                                <RowDefinition />
                                            </Grid.RowDefinitions>
                                            <Grid.ColumnDefinitions>
                                                <ColumnDefinition Width="0.7*" />
                                                <ColumnDefinition />
                                                <ColumnDefinition Width="0.6*"/>
                                                <ColumnDefinition />
                                            </Grid.ColumnDefinitions>
                                            <Label Grid.Row="0" Grid.Column="0" Content="Recipe:" BorderBrush="Black"  BorderThickness="1" />
                                            <Label Grid.Row="1" Grid.Column="0" Content="Cassette ID:"  BorderBrush="Black"  BorderThickness="1" />
                                            <Label Grid.Row="2" Grid.Column="0" Content="Wafer ID:"  BorderBrush="Black"  BorderThickness="1" />
                                            <Label Grid.Row="3" Grid.Column="0" Content="Wafer Size:"  BorderBrush="Black"  BorderThickness="1" />


                                            <Label Grid.Row="0" Grid.Column="1" BorderBrush="Black"  BorderThickness="1" />
                                            <Label Grid.Row="1" Grid.Column="1" BorderBrush="Black"  BorderThickness="1" />
                                            <Label Grid.Row="2" Grid.Column="1" BorderBrush="Black"  BorderThickness="1" />
                                            <Label Grid.Row="3" Grid.Column="1" BorderBrush="Black"  BorderThickness="1" />

                                            <Label Grid.Row="0" Grid.Column="2" Content="Progress :"  BorderBrush="Black"  BorderThickness="1" />
                                            <Label Grid.Row="1" Grid.Column="2" Content="Progress :"  BorderBrush="Black"  BorderThickness="1" />

                                            <Label Grid.Row="0" Grid.Column="3" BorderBrush="Black"  BorderThickness="1" />
                                            <Label Grid.Row="1" Grid.Column="3" BorderBrush="Black"  BorderThickness="1" />
                                        </Grid>
                                    </Grid>
                                </GroupBox>
                            </TabItem>
                            <TabItem Header="WaferID" Height="10" Visibility="{Binding InformationUCVisibility}" >
                                <Grid>
                                    <Grid.ColumnDefinitions>
                                        <ColumnDefinition/>
                                        <ColumnDefinition/>
                                    </Grid.ColumnDefinitions>
                                    <GroupBox Header="WaferID Picture" FontSize="15" Grid.Column="0">
                                        <Image Grid.Column="0" Grid.Row="2" Source ="{Binding ResultImage}"/>
                                    </GroupBox>
                                    <GroupBox Header="Key In" FontSize="15" Grid.Column="1">
                                        <Grid>
                                            <Grid.RowDefinitions>
                                                <RowDefinition />
                                                <RowDefinition />
                                                <RowDefinition />
                                            </Grid.RowDefinitions>
                                            <Grid.ColumnDefinitions >
                                                <ColumnDefinition/>
                                                <ColumnDefinition/>
                                            </Grid.ColumnDefinitions>
                                            <TextBlock Grid.ColumnSpan="2" Text="Wafer ID:" FontSize="32" HorizontalAlignment="Left" VerticalAlignment="Bottom"    />
                                            <TextBox Grid.ColumnSpan="2" Text="{Binding WaferIDManualKeyIn}"  Width="435" FontSize="32" Grid.Row="1" HorizontalContentAlignment="Left" VerticalAlignment="Center"/>
                                            <Button Grid.Column="1" Grid.Row="2" Content="Confirm" Command="{Binding WaferIDConfirmOperateCommand}"  Width="150" Height="40" Margin="5"/>
                                        </Grid>
                                        
                                    </GroupBox>
                                </Grid>
                                
                            </TabItem>
                            <TabItem Header="Alignment"  Visibility="{Binding InformationUCVisibility}" Height="10"  >
                                <Border     BorderBrush="{DynamicResource PrimaryHueMidBrush}"   BorderThickness="1"  >
                                    <Grid >
                                        <Grid.ColumnDefinitions >
                                            <ColumnDefinition Width="85*"/>
                                            <ColumnDefinition Width="369*"/>
                                            <ColumnDefinition Width="159*"/>
                                            <ColumnDefinition Width="295*"/>
                                        </Grid.ColumnDefinitions>
                                        <GroupBox Grid.Column="0" Grid.Row="0" Header="Alignment Target Pos" FontSize="15" Grid.ColumnSpan="2">
                                            <Grid Margin="-5">
                                                <Grid.RowDefinitions>
                                                    <RowDefinition Height="0.35*"/>
                                                    <RowDefinition/>
                                                </Grid.RowDefinitions>
                                                <Grid Grid.Column="0">
                                                    <Border BorderBrush="Black" BorderThickness="1">
                                                        <StackPanel Orientation="Horizontal"   >
                                                            <Label Content="X:" FontSize="32" Width="40"  />
                                                            <TextBox Text="{Binding ManualPosX}"  Width="160" FontSize="32"  />
                                                            <Label Content="Y:" FontSize="32" Width="40" />
                                                            <TextBox Text="{Binding ManualPosY}"  Width="160" FontSize="32" />
                                                        </StackPanel>
                                                    </Border>


                                                </Grid>
                                                <Grid Grid.Row="1" >
                                                    <Grid.RowDefinitions>
                                                        <RowDefinition />

                                                        <RowDefinition  Height="0.8*" />
                                                        <RowDefinition Height="1.1*" />
                                                    </Grid.RowDefinitions>
                                                    <StackPanel Orientation="Horizontal" Grid.Row="0"  >
                                                        <Button   Height="60" Width="150" Content="Find" Command="{Binding ManualReFindCommand}"  FontSize="26" Cursor="Hand" />
                                                        <Button  Margin="5,0,0,0" Height="60" Width="150" Command="{Binding ManualMoveCommand}" Content="Move"  FontSize="26" />
                                                        <Button  Margin="5,0,0,0" Height="60" Width="150" Command="{Binding ManualGetPosCommand}" Content="Get Pos"  FontSize="26" />
                                                    </StackPanel>


                                                    <Button Margin="5" Grid.Row="3"  Height="60" Content="Confirm" Command="{Binding AlignmentOperateCommand}"  FontSize="26" />
                                                </Grid>

                                            </Grid>


                                        </GroupBox>
                                        <GroupBox Grid.Column="2" Grid.Row="0" Header="WorkItem" FontSize="15" Grid.ColumnSpan="2">
                                            <Grid>
                                                <UserControlUC:WorkholderUC Grid.Column="1" TableX="{Binding TableX }" TableY="{Binding TableY }" TablePosX="{Binding TablePosX}" TablePosY="{Binding TablePosY}" HorizontalAlignment="Left" VerticalAlignment="Top"  />
                                            </Grid>
                                        </GroupBox>
                                    </Grid>
                                </Border>
                            </TabItem>
                            <TabItem Header="Micro Judge" FontSize="10" Visibility="{Binding InformationUCVisibility}" Height="10"   >
                                <Grid>
                                    <Grid.ColumnDefinitions >
                                        <ColumnDefinition Width="0.19*" />
                                        <ColumnDefinition Width="0.19*" />
                                        <ColumnDefinition Width="0.62*"/>
                                    </Grid.ColumnDefinitions>
                                    <Grid Grid.Column="0" Grid.ColumnSpan="2">
                                        <Grid.ColumnDefinitions>
                                            <ColumnDefinition />
                                            <ColumnDefinition />
                                        </Grid.ColumnDefinitions>
                                        <Grid.RowDefinitions >
                                            <RowDefinition Height="0.2*"/>
                                            <RowDefinition Height="0.8*"/>
                                        </Grid.RowDefinitions>
                                        <GroupBox  Grid.Column="0" Grid.ColumnSpan="2" Header="Now Idx" FontSize="12">

                                            <StackPanel Orientation="Horizontal" Margin=" 0,-10,0,-5"  >
                                                <Label Content="Col:" Width="50" VerticalAlignment="Center" FontSize="15" />
                                                <TextBox Text="{Binding MicroCheckNowIndexX}"  VerticalAlignment="Center"  FontSize="15"   Width="70" />
                                                <Label Content="Row:" Width="50" VerticalAlignment="Center" FontSize="15" />
                                                <TextBox Text="{Binding MicroCheckNowIndexY}"  VerticalAlignment="Center"  FontSize="15"  Width="70" />
                                            </StackPanel>
                                        </GroupBox>
                                        <Grid Grid.Column="0" Grid.ColumnSpan="2">



                                        </Grid>
                                        <GroupBox Grid.Column="0" Grid.Row="1" Header="Bin Code List" Grid.ColumnSpan="2" FontSize="12">
                                            <DataGrid Margin="0" ItemsSource="{Binding BincodeList}"  CanUserSortColumns="False" 
                                                    AutoGenerateColumns="False" SelectionUnit="FullRow" SelectedIndex="{Binding SelectList}" FontSize="10" >
                                                <i:Interaction.Triggers>
                                                    <i:EventTrigger EventName="PreviewMouseDoubleClick">
                                                        <i:InvokeCommandAction Command="{Binding MouseCombineClickCommand}"/>
                                                    </i:EventTrigger>
                                                </i:Interaction.Triggers>
                                                <DataGrid.Columns >
                                                    <DataGridTemplateColumn Header="Color" Width="60"  >
                                                        <DataGridTemplateColumn.CellTemplate>
                                                            <DataTemplate>
                                                                <StackPanel Orientation="Horizontal">
                                                                    <Button  Width="60"  Height="30"  Content="Click" Click="OpenPalette_Click"  BorderBrush="{Binding Color}"  Background="{Binding Color}" />
                                                                </StackPanel>
                                                            </DataTemplate>
                                                        </DataGridTemplateColumn.CellTemplate>
                                                    </DataGridTemplateColumn>
                                                    <DataGridTextColumn  Width="70"  Header="Code"  Binding="{Binding Code}"    />
                                                    <DataGridTextColumn  Width="120"  Header="Describe"  Binding="{Binding Describe}"  />
                                                </DataGrid.Columns>
                                            </DataGrid>
                                        </GroupBox>
                                    </Grid>


                                    <TabControl Grid.Column="2"  Style="{StaticResource MaterialDesignFilledTabControl}"  >
                                        <TabItem Height="30">
                                            <TabItem.Header>
                                                <StackPanel Orientation="Horizontal" >
                                                    <TextBlock Text="Defect List" Grid.Column="1"  Margin="0,-10,0,-10" FontSize="15" />
                                                </StackPanel>
                                            </TabItem.Header>
                                            <Grid>
                                                <Grid.RowDefinitions >
                                                    <RowDefinition Height="0.12*"/>
                                                    <RowDefinition Height="0.88*"/>
                                                </Grid.RowDefinitions>
                                                <StackPanel Orientation="Horizontal" Grid.Row="0" Margin="0,0,0,-10">
                                                    <Button Content="Grab" Width="150" Height="30" Margin=" 0,0,0,0"/>
                                                    <Button Content="Next Wafer" Width="150" Height="30" Margin="110,0,0,0" Command="{Binding NextWaferCommand}" />
                                                </StackPanel>
                                                <DataGrid Grid.Row="1" Margin="0,10,0,0" ItemsSource="{Binding DetectionPointList}"  CanUserSortColumns="False" 
                                                      FontSize="10" 
                                                    AutoGenerateColumns="False" SelectionUnit="FullRow" SelectedIndex="{Binding SelectDetectionPointList}"   >
                                                    <i:Interaction.Triggers>
                                                        <i:EventTrigger EventName="PreviewMouseDoubleClick">
                                                            <i:InvokeCommandAction Command="{Binding MouseCombineClickCommand}"/>
                                                        </i:EventTrigger>
                                                    </i:Interaction.Triggers>
                                                    <DataGrid.Columns >
                                                        <DataGridTextColumn  Width="50"  Header="Idx"  Binding="{Binding IndexX}"  />
                                                        <DataGridTextColumn  Width="50"  Header="Col"  Binding="{Binding IndexX}"  />
                                                        <DataGridTextColumn  Width="55"  Header="Row"  Binding="{Binding IndexY}"  />
                                                        <DataGridTextColumn  Width="120"  Header="PositionX"  Binding="{Binding Position.X}"  />
                                                        <DataGridTextColumn  Width="120"  Header="PositionY"  Binding="{Binding Position.Y}"  />
                                                        <DataGridTextColumn  Width="80"  Header="BinCode"  Binding="{Binding Code}"  />
                                                    </DataGrid.Columns>
                                                </DataGrid>
                                            </Grid>
                                        </TabItem>
                                        <TabItem  Height="30">
                                            <TabItem.Header>
                                                <StackPanel Orientation="Horizontal" >
                                                    <TextBlock Text="Microscope" Grid.Column="1"  Margin="0,-10,0,-10" FontSize="15" />
                                                </StackPanel>
                                            </TabItem.Header>
                                            <Grid>
                                                <Grid.RowDefinitions >
                                                    <RowDefinition Height="0.12*"/>
                                                    <RowDefinition Height="0.88*"/>
                                                </Grid.RowDefinitions>
                                                <StackPanel Orientation="Horizontal" Grid.Row="0" Margin="0,0,0,-10">
                                                    <Button Content="Grab" Width="150" Height="30" Margin=" 0,0,0,0"/>
                                                    <Button Content="Next Wafer" Width="150" Height="30" Margin="110,0,0,0"/>
                                                    <!--<Button Content="ERROR" Width="150" Height="30" Margin="55,0,0,0"/>-->
                                                </StackPanel>
                                                <microscope:BXFMUC Grid.Column="0" Grid.Row="1" Microscope="{Binding Microscope}"   MicroscopeParam="{Binding MicroscopeParam}" Margin="0,10,0,0" HorizontalAlignment="Left" Width="565" />
                                            </Grid>
                                        </TabItem>
                                        <TabItem Height="30">
                                            <TabItem.Header>
                                                <StackPanel Orientation="Horizontal" >
                                                    <TextBlock Text="WorkItem" Grid.Column="1"  Margin="0,-10,0,-10" FontSize="15" />
                                                </StackPanel>
                                            </TabItem.Header>
                                            <Grid >
                                                <Grid.ColumnDefinitions>
                                                    <ColumnDefinition Width="213*"/>
                                                    <ColumnDefinition Width="16*"/>
                                                    <ColumnDefinition Width="335*"/>
                                                </Grid.ColumnDefinitions>
                                                <Grid.RowDefinitions >
                                                    <RowDefinition Height="0.12*"/>
                                                    <RowDefinition Height="0.88*"/>
                                                </Grid.RowDefinitions>
                                                <StackPanel Orientation="Horizontal" Margin="0,0,0,225" Grid.ColumnSpan="3" Grid.RowSpan="2">
                                                    <Button Content="Grab" Width="150"/>
                                                    <Button Content="Next Wafer" Width="150" Height="30" Margin="110,0,0,0"/>
                                                </StackPanel>
                                                <UserControlUC:WorkholderUC Grid.Row ="1" TableX="{Binding TableX }" TableY="{Binding TableY }" TablePosX="{Binding TablePosX}" TablePosY="{Binding TablePosY}" HorizontalAlignment="Left" VerticalAlignment="top" Margin="0,10,0,0" Height="190" Width="320" Grid.ColumnSpan="3"/>
                                            </Grid>
                                        </TabItem>
                                    </TabControl>

                                </Grid>
                            </TabItem>
                            <TabItem Header="MacroJudge" Visibility="{Binding InformationUCVisibility}" Height="10"   >
                                <Border  BorderBrush="{DynamicResource PrimaryHueMidBrush}"  BorderThickness="1">
                                    <Grid>

                                        <Grid.ColumnDefinitions>

                                            <ColumnDefinition Width="202*"/>
                                            <ColumnDefinition Width="73*"/>
                                            <ColumnDefinition Width="179*"/>
                                        </Grid.ColumnDefinitions>

                                        <GroupBox Grid.Column="0" Header="Macro Judge"  FontSize="15" >
                                            <StackPanel Orientation="Vertical" Grid.Column="0" Grid.Row="1" Margin="-8,0,-8,0">

                                                <StackPanel Orientation="Horizontal" Grid.Row="0" Grid.Column="0" Height="60">
                                                    <Button Content="PASS" Command="{Binding MacroPASSOperateCommand}"  Width="150" Height="40" Margin="5,0,0,0"/>
                                                    <Button Content="Reject" Command="{Binding MacroRejectOperateCommand}"   Width="150" Height="40" Margin="55,0,0,0"/>
                                                </StackPanel>


                                                <UserControlUC:LampUnitUC Margin="0,10,0,0" HorizontalAlignment="Left" Width="400" LampControl="{Binding LampControl1}" LampUIShow="{Binding LampControl1Param}"/>
                                                <UserControlUC:LampUnitUC Margin="0,0,0,0" HorizontalAlignment="Left" Width="400" LampControl="{Binding LampControl2}" LampUIShow="{Binding LampControl2Param}"/>

                                            </StackPanel>
                                        </GroupBox>
                                        <GroupBox Grid.Column="1" Header="WorkItem" FontSize="15" Grid.ColumnSpan="2" >
                                            <Grid>
                                                <Grid.RowDefinitions >
                                                    <RowDefinition Height="0.15*"/>
                                                    <RowDefinition Height="0.85*"/>
                                                </Grid.RowDefinitions>
                                                <Button Grid.Column="1" Grid.Row="0" Width="140" Height="30" HorizontalAlignment="Left" VerticalAlignment="Center" Content="Grab" Margin="5,0,0,0" />
                                                <UserControlUC:MacroUnitUC Grid.Column="3" Grid.Row="1" Margin="0,0,0,0" VerticalAlignment="Top" HorizontalAlignment="Left"  Macro="{Binding Macro}" MacroStatus="{Binding MacroStatus}" />
                                            </Grid>
                                        </GroupBox>
                                    </Grid>
                                </Border>
                            </TabItem>
                        </TabControl>
                    </Grid>
                </Grid>



            </TabItem>
            <!--料號設定頁-->
            <TabItem  Height="75" IsSelected="{Binding IsMainRecipePageSelect}"  >

                <TabItem.Header>
                    <StackPanel Width="auto"   Height="auto">
                        <materialDesign:PackIcon Width="34" Height="34" HorizontalAlignment="Center"  Kind="FileDocumentEdit" />
                        <TextBlock   HorizontalAlignment="Center" Text="Recipe" />
                    </StackPanel>
                </TabItem.Header>
                <Grid >
                    <Grid.ColumnDefinitions>
                        <ColumnDefinition Width="2.2*"/>
                        <ColumnDefinition/>
                    </Grid.ColumnDefinitions>
                    <Grid.RowDefinitions>
                        <RowDefinition />
                        <RowDefinition  Height="0.40*"/>
                    </Grid.RowDefinitions>
                    <Grid>
                        <Grid.ColumnDefinitions>
                            <ColumnDefinition Width="1.3*"/>
                            <ColumnDefinition/>
                        </Grid.ColumnDefinitions>
                        <viewsNew:WaferMappingCanvas Margin="0,0,0,0" Grid.Row="0" IsShowBar="True"  ImageSource="{Binding MapImage}" ItemsSource="{Binding MapDrawings}"   
                                                     IsMoveEnable="{Binding MapIsMoveEnable}"    MousePixcel="{Binding MapMousePixcel}"     AddShapeAction="{Binding AddMapShapeAction}" ClearShapeAction="{Binding ClearMapShapeAction}" RemoveShapeAction="{Binding RemoveMapShapeAction}" SaveAction="{Binding SaveMappingAction}"  >
                            <i:Interaction.Triggers>
                                <i:EventTrigger EventName="PreviewMouseDoubleClick">
                                    <i:InvokeCommandAction Command="{Binding SelectMappingDieCommand}"/>
                                </i:EventTrigger>
                            </i:Interaction.Triggers>
                        </viewsNew:WaferMappingCanvas>
                        <Grid  Grid.Column="1"  >
                            <Grid.RowDefinitions>
                                <RowDefinition Height="0.77*"/>
                                <RowDefinition  Height="0.23*"/>
                            </Grid.RowDefinitions>

                            <views:VirtualCanvas Grid.Row="0"  Grid.Column="0" ImageSource="{Binding MainImage}" ItemsSource="{Binding Drawings}"   MousePixcel="{Binding MousePixcel}" AddShapeAction="{Binding AddShapeAction}" ClearShapeAction="{Binding ClearShapeAction}" />
                            <GroupBox Header="MAP" Grid.Row="1" Grid.Column="1"      >
                                <Grid>
                                    <Grid.ColumnDefinitions>
                                        <ColumnDefinition/>
                                        <ColumnDefinition/>
                                    </Grid.ColumnDefinitions>
                                    <Grid.RowDefinitions>
                                        <RowDefinition />
                                        <RowDefinition />

                                    </Grid.RowDefinitions>
                                    <Button Margin="5" Content="Load Map" FontSize="20" Height="50" Width="140" Command="{Binding LoadMappingCommand}" />
                                    <Button Grid.Column="1" Content="MapLayout Edit" FontSize="20" Height="50" Width="200" Command="{Binding EditMappingCommand}"  />

                                    <Button Grid.Column="0" Grid.Row="2" Content="WaferToLoadPort" Command="{Binding EFEMTransToLoadPortCommand}" IsEnabled="{Binding IsCanWorkEFEMTrans}" Width="150" Height="40" HorizontalAlignment="Left" />
                                    <Button Grid.Row="1" Grid.Column="1" Content="TEST" FontSize="20" Height="50" Width="200"  Command="{Binding MappingTestCommand}" Cursor="Hand" />
                                </Grid>

                            </GroupBox>

                        </Grid>

                    </Grid>
                    <Grid Grid.Column="1" Grid.RowSpan="2" >
                        <Grid.RowDefinitions>
                            <RowDefinition Height="1*"/>

                        </Grid.RowDefinitions>
                        <Grid  Grid.Row="0">
                            <Border     BorderBrush="{DynamicResource PrimaryHueMidBrush}"   BorderThickness="1" >

                                <TabControl>
                                    <TabItem  Width="180"  IsSelected="{Binding IsLoadwaferPageSelect}"  >
                                        <!-- 在 TabItem 的 Header 中添加一個 StackPanel，包含 TextBlock 和 Image -->
                                        <TabItem.Header >
                                            <Grid Margin="-10" Width="180"  >
                                                <Grid.ColumnDefinitions>
                                                    <ColumnDefinition />
                                                    <ColumnDefinition Width="3*" />
                                                    <ColumnDefinition />
                                                </Grid.ColumnDefinitions>
                                                <usercontrols:SignalUC Width="20" Height="20"  Margin="-10,0,0,0" IsSignal="{Binding IsLoadwaferComplete}"  />
                                                <TextBlock Text="Load Wafer" Grid.Column="1"  Margin="-10,0,0,0" FontSize="22" />
                                                <materialDesign:PackIcon Grid.Column="2"  Margin="0,0,0,0" Width="30"  Height="30"  Kind="ArrowRightBold" />

                                            </Grid>
                                        </TabItem.Header>
                                        <!-- TabItem 的內容 -->

                                        <Grid Grid.Row="0">
                                            <Grid.RowDefinitions>
                                                <RowDefinition Height="0.5*"/>
                                                <RowDefinition Height="0.5*"/>
                                            </Grid.RowDefinitions>
                                            <Grid.ColumnDefinitions >
                                                <ColumnDefinition Width="0.20*"/>
                                                <ColumnDefinition Width="0.7*"/>
                                            </Grid.ColumnDefinitions>
                                            <GroupBox Grid.Row="0" Grid.Column="0" Grid.RowSpan="1" Header="Load Port" >

                                                <Grid >
                                                    <Grid Margin="-5">
                                                        <Grid.ColumnDefinitions>
                                                            <ColumnDefinition />
                                                        </Grid.ColumnDefinitions>
                                                        <usercontrols1:CassetteStateUC Grid.Column="0" Margin="0"  LoadPortWafers="{Binding LoadPort1Wafers}" SelectIndex="{Binding LoadPort1WaferSelect}"  />
                                                        <!--<usercontrols1:CassetteStateUC Grid.Column="1" Margin="0"  LoadPortWafers="{Binding LoadPort2Wafers}"/>-->


                                                        <!--<ListBox Grid.Column="0" Margin="0" ItemsSource="{Binding LoadPort1Wafers}">
                                                            <ListBox.ItemContainerStyle>
                                                                <Style TargetType="ListBoxItem">
                                                                    <Setter Property="Margin" Value="0"/>
                                                                </Style>
                                                            </ListBox.ItemContainerStyle>
                                                            <ListBox.ItemTemplate>
                                                                <DataTemplate>
                                                                     -->
                                                        <!--這裡放置你的 UserControl-->
                                                        <!-- 
                                                                    <wls3200controls:ExistNotifyUC ExistState="{Binding WaferStates}" />
                                                                    -->
                                                        <!--<Button/>-->
                                                        <!--
                                                                </DataTemplate>
                                                            </ListBox.ItemTemplate>
                                                        </ListBox>-->

                                                    </Grid>
                                                </Grid>

                                            </GroupBox>




                                            <GroupBox Header="Aligner"  Grid.Row="0" Grid.Column="1">
                                                <Grid Margin="-5" >
                                                    <Grid >
                                                        <Grid.Resources>
                                                            <!-- 定義一個名為 GroupBoxStyle 的樣式 -->
                                                            <Style TargetType="GroupBox" x:Key="GroupBoxStyle">
                                                                <!-- 將 GroupBox 的背景顏色設置為白色 -->
                                                                <Setter Property="Background" Value="White"/>
                                                            </Style>
                                                        </Grid.Resources>
                                                        <Grid.RowDefinitions>
                                                            <RowDefinition />
                                                            <RowDefinition />
                                                            <RowDefinition />
                                                            <RowDefinition />
                                                            <RowDefinition />
                                                        </Grid.RowDefinitions>
                                                        <Grid.ColumnDefinitions>
                                                            <ColumnDefinition Width="0.4*"/>
                                                            <ColumnDefinition Width="0.3*"/>
                                                            <ColumnDefinition Width="0.3*"/>
                                                        </Grid.ColumnDefinitions>
                                                        <TextBlock Grid.Row="0"  Grid.Column="0"  Text="Micro Angle:" FontSize="20"  VerticalAlignment="Center" />
                                                        <TextBox  Grid.Row="0"  Grid.Column="1" VerticalAlignment="Center" Width="125" Text="{Binding AlignerMicroAngle}"/>
                                                        <Button Grid.Row="0"  Grid.Column="2" Content="Run" Command="{Binding AlignerCommand}" CommandParameter="NotchAngle" IsEnabled="{Binding IsCanWorkEFEMTrans}"/>

                                                        <TextBlock Grid.Row="1"  Grid.Column="0"  Text="Wafer ID Angle:" FontSize="20"  VerticalAlignment="Center" />
                                                        <TextBox  Grid.Row="1"  Grid.Column="1" VerticalAlignment="Center" Width="125" Text="{Binding AlignerWaferIDAngle}"/>
                                                        <Button Grid.Row="1"  Grid.Column="2" Content="Run" Command="{Binding AlignerCommand}" CommandParameter="WaferIDAngle" IsEnabled="{Binding IsCanWorkEFEMTrans}"/>


                                                        <Button Grid.Column="2" Grid.Row="2" Content="WaferToAligner" Command="{Binding EFEMTransToAlignerCommand}" CommandParameter="WaferToAligner" IsEnabled="{Binding IsCanWorkEFEMTrans}" Width="150" Height="40" HorizontalAlignment="Left" Margin="-20,0,-20,0"/>

                                                        <GroupBox Grid.Column="0" Grid.Row="3" Grid.RowSpan="2" Grid.ColumnSpan="3" Margin="0,0,0,0" materialDesign:ColorZoneAssist.Background="DeepSkyBlue" materialDesign:ColorZoneAssist.Foreground="White"
                                                              materialDesign:ColorZoneAssist.Mode="Custom"   FontSize="12" Header="WaferID Reader" Style="{StaticResource GroupBoxStyle}">
                                                            <UserControlUC:ReaderUnitUC Grid.Row="4" Grid.ColumnSpan="3" VerticalAlignment="Center" HorizontalAlignment="Left"  />
                                                        </GroupBox>
                                                    </Grid>
                                                </Grid>
                                            </GroupBox>
                                            <GroupBox Header="Macro" Grid.Column="0" Grid.Row="1" Grid.ColumnSpan="2">
                                                <Grid Margin="-5,-5,-5,-5">
                                                    <Grid.ColumnDefinitions>
                                                        <ColumnDefinition/>
                                                        <ColumnDefinition/>
                                                    </Grid.ColumnDefinitions>
                                                    <Grid.RowDefinitions >
                                                        <RowDefinition Height="0.12*"/>
                                                        <RowDefinition Height="0.40*"/>
                                                        <RowDefinition Height="0.48*"/>
                                                    </Grid.RowDefinitions>
                                                    <Grid.Resources>
                                                        <!-- 定義一個名為 GroupBoxStyle 的樣式 -->
                                                        <Style TargetType="GroupBox" x:Key="GroupBoxStyle">
                                                            <!-- 將 GroupBox 的背景顏色設置為白色 -->
                                                            <Setter Property="Background" Value="White"/>
                                                        </Style>
                                                    </Grid.Resources>
                                                    <GroupBox Grid.Column="0" Grid.Row="0" Grid.ColumnSpan="2" Margin="0,0,0,0" materialDesign:ColorZoneAssist.Background="DeepSkyBlue" materialDesign:ColorZoneAssist.Foreground="White"
                                                              materialDesign:ColorZoneAssist.Mode="Custom"   FontSize="12" Header="Light" Style="{StaticResource GroupBoxStyle}">
                                                        <Grid>
                                                            <Grid.ColumnDefinitions >
                                                                <ColumnDefinition />
                                                                <ColumnDefinition />
                                                            </Grid.ColumnDefinitions>
                                                            <Grid.RowDefinitions >
                                                                <RowDefinition Height="0.3*"/>
                                                                <RowDefinition Height="0.7*"/>
                                                            </Grid.RowDefinitions>
                                                            <TextBlock Grid.Column="0" Grid.Row="0"   Text="Left" FontSize="15"  VerticalAlignment="Top"    HorizontalAlignment="Center" Margin="0,-5,0,-5"/>
                                                            <TextBlock Grid.Column="1" Grid.Row="0"   Text="Right" FontSize="15"  VerticalAlignment="Top" HorizontalAlignment="Center" Margin="0,-5,0,-5"/>
                                                            <UserControlUC:LampUnitUC Grid.Column="0" Grid.Row="1" Margin="10,0,0,0" HorizontalAlignment="Left" Width="250" Height="25" LampControl="{Binding LampControl1}" LampUIShow="{Binding LampControl1Param}" />
                                                            <UserControlUC:LampUnitUC Grid.Column="1" Grid.Row="1" Margin="10,0,0,0" HorizontalAlignment="Left" Width="250" Height="25" LampControl="{Binding LampControl2}" LampUIShow="{Binding LampControl2Param}"/>
                                                        </Grid>
                                                    </GroupBox>
                                                    <Grid Grid.Column="0" Grid.Row="1" Grid.ColumnSpan="2">
                                                        <Grid.ColumnDefinitions>
                                                            <ColumnDefinition Width="0.75*"/>
                                                            <ColumnDefinition Width="0.25*"/>
                                                        </Grid.ColumnDefinitions>
                                                        <GroupBox Grid.Column="0" Grid.Row="1"  Margin="0,0,0,0" materialDesign:ColorZoneAssist.Background="DeepSkyBlue" materialDesign:ColorZoneAssist.Foreground="White"
                                                              IsEnabled="{Binding MacroStatus.IsProcessStop }"
                                                              materialDesign:ColorZoneAssist.Mode="Custom"   FontSize="12" Header="Start Position" Style="{StaticResource GroupBoxStyle}">
                                                            <Grid>
                                                                <Grid.RowDefinitions >
                                                                    <RowDefinition />
                                                                    <RowDefinition />
                                                                    <RowDefinition />
                                                                    <RowDefinition />
                                                                </Grid.RowDefinitions>
                                                                <Grid.ColumnDefinitions >
                                                                    <ColumnDefinition Width="0.19*"/>
                                                                    <ColumnDefinition Width="0.19*"/>
                                                                    <ColumnDefinition Width="0.19*"/>
                                                                    <ColumnDefinition Width="0.19*"/>
                                                                    <ColumnDefinition Width="0.24*"/>
                                                                </Grid.ColumnDefinitions>

                                                                <TextBlock Grid.Column="0" Grid.Row="0"   Text="Pitch X:" FontSize="20"  VerticalAlignment="Center" />
                                                                <TextBox Grid.Column="1" Grid.Row="0" Text="{Binding MacroTopStartPitchX}"   FontSize="20"  Width="70" VerticalAlignment="Center"   />
                                                                <TextBlock Grid.Column="2" Grid.Row="0"   Text="Roll Y:" FontSize="20"  VerticalAlignment="Center" />
                                                                <TextBox Grid.Column="3" Grid.Row="0" Text="{Binding MacroTopStartRollY}"   FontSize="20"  Width="70" VerticalAlignment="Center"  />
                                                                <TextBlock Grid.Column="2" Grid.Row="1"   Text="Yaw T:" FontSize="20"  VerticalAlignment="Center" />
                                                                <TextBox Grid.Column="3" Grid.Row="1" Text="{Binding MacroTopStartYawT}"   FontSize="20"  Width="70" VerticalAlignment="Center"  />
                                                                <Button Grid.Column="4" Grid.Row="0" Content="TopMove" Command="{Binding MacroCommand}" CommandParameter="TopMove" Width="100" Height="30" HorizontalAlignment="Left" FontSize="12" IsEnabled="{Binding IsCanWorkEFEMTrans}" />


                                                                <TextBlock Grid.Column="0" Grid.Row="3"   Text="Flip Y:" FontSize="20"  VerticalAlignment="Center" />
                                                                <TextBox Grid.Column="1" Grid.Row="3" Text="{Binding MacroBackStartPos}"   FontSize="20"  Width="70" VerticalAlignment="Center"  />
                                                                <Button Grid.Column="4" Grid.Row="3" Content="BackMove" Command="{Binding MacroCommand}" CommandParameter="BackMove" Width="100" Height="30" HorizontalAlignment="Left" FontSize="12" IsEnabled="{Binding IsCanWorkEFEMTrans}" />

                                                            </Grid>
                                                        </GroupBox>
                                                        <GroupBox Grid.Column="1" Grid.Row="1"  Margin="0,0,0,0" materialDesign:ColorZoneAssist.Background="DeepSkyBlue" materialDesign:ColorZoneAssist.Foreground="White"
                                                              IsEnabled="{Binding MacroStatus.IsProcessStop }"
                                                              materialDesign:ColorZoneAssist.Mode="Custom"   FontSize="12" Header="Start LightValue" Style="{StaticResource GroupBoxStyle}">
                                                            <Grid >
                                                                <Grid.RowDefinitions >
                                                                    <RowDefinition />
                                                                    <RowDefinition />
                                                                    <RowDefinition />
                                                                    <RowDefinition />
                                                                </Grid.RowDefinitions>
                                                                <Grid.ColumnDefinitions >
                                                                    <ColumnDefinition/>
                                                                    <ColumnDefinition/>
                                                                </Grid.ColumnDefinitions>
                                                                <TextBlock Grid.Column="0" Grid.Row="0"   Text="Top L:" FontSize="15"  VerticalAlignment="Center" />
                                                                <TextBox Grid.Column="1" Grid.Row="0" Text="{Binding MacroTopLeftLightValue}"   FontSize="20"  Width="70" VerticalAlignment="Center"/>

                                                                <TextBlock Grid.Column="0" Grid.Row="1"   Text="Top R:" FontSize="15"  VerticalAlignment="Center" />
                                                                <TextBox Grid.Column="1" Grid.Row="1" Text="{Binding MacroTopRightLightValue}"   FontSize="20"  Width="70" VerticalAlignment="Center"/>

                                                                <TextBlock Grid.Column="0" Grid.Row="2"   Text="Back L:" FontSize="15"  VerticalAlignment="Center" />
                                                                <TextBox Grid.Column="1" Grid.Row="2" Text="{Binding MacroBackLeftLightValue}"   FontSize="20"  Width="70" VerticalAlignment="Center"/>

                                                                <TextBlock Grid.Column="0" Grid.Row="3"   Text="Back R:" FontSize="15"  VerticalAlignment="Center" />
                                                                <TextBox Grid.Column="1" Grid.Row="3" Text="{Binding MacroBackRightLightValue}"   FontSize="20"  Width="70" VerticalAlignment="Center"/>

                                                            </Grid>
                                                        </GroupBox>
                                                    </Grid>

                                                    <GroupBox Grid.Column="0" Grid.Row="2" Grid.ColumnSpan="2" Margin="0,0,0,0"  Style="{StaticResource GroupBoxStyle}"
                                                              materialDesign:ColorZoneAssist.Mode="Custom"   FontSize="14" Header="Control"  >
                                                        <Grid >
                                                            <Grid.ColumnDefinitions >
                                                                <ColumnDefinition Width="0.7*"/>
                                                                <ColumnDefinition Width="0.3*"/>
                                                            </Grid.ColumnDefinitions>
                                                            <UserControlUC:MacroUnitUC Grid.Column="0" Grid.Row="0" Margin="0,0,0,0" VerticalAlignment="Top" HorizontalAlignment="Left"  Macro="{Binding Macro}" MacroStatus="{Binding MacroStatus}" IsEnabled="{Binding IsCanWorkEFEMTrans}" />
                                                            <Grid Grid.Column="1">
                                                                <Grid.RowDefinitions >
                                                                    <RowDefinition Height="0.5*"/>
                                                                    <RowDefinition Height="0.5*"/>
                                                                    <RowDefinition Height="0.5*"/>
                                                                </Grid.RowDefinitions>
                                                                <StackPanel Grid.Row="0"   Grid.Column="1" Orientation="Horizontal">
                                                                    <TextBlock   Text="Vacuum:" FontSize="20"  VerticalAlignment="Center" />
                                                                    <usercontrols:SignalUC Margin="2" Width="20" Height="20" IsSignal="False" />
                                                                </StackPanel>
                                                                <Button Grid.Row="1" Content="WaferToMacro" Command="{Binding EFEMTransToMacroCommand}" CommandParameter="WaferToMacro" IsEnabled="{Binding IsCanWorkEFEMTrans}" Width="150" Height="40" HorizontalAlignment="Left" />
                                                            </Grid>

                                                        </Grid>
                                                    </GroupBox>
                                                </Grid>

                                            </GroupBox>




                                        </Grid>
                                    </TabItem>

                                    <TabItem Width="160"  IsSelected="{Binding IsLocatePageSelect}" >
                                        <TabItem.Header>
                                            <Grid Margin="-10" Width="160"  >
                                                <Grid.ColumnDefinitions>
                                                    <ColumnDefinition />
                                                    <ColumnDefinition Width="2.5*" />
                                                    <ColumnDefinition />
                                                </Grid.ColumnDefinitions>
                                                <usercontrols:SignalUC Width="20" Height="20"  Margin="-10,0,0,0" IsSignal="{Binding IsLocateComplete}"  />
                                                <TextBlock Text="Locate" Grid.Column="1"  Margin="-10,0,0,0" FontSize="22" />
                                                <materialDesign:PackIcon Grid.Column="2" Margin="-10,0,0,0"  Width="30"  Height="30"  Kind="ArrowRightBold" />
                                            </Grid>
                                        </TabItem.Header>
                                        <Grid   Grid.Column="1">

                                            <Grid.ColumnDefinitions>
                                                <ColumnDefinition  Width="0.5*"/>
                                                <ColumnDefinition  Width="2.0*"/>
                                            </Grid.ColumnDefinitions>

                                            <Grid Grid.Column="1">
                                                <StackPanel  Margin="2,2,2,10"    Orientation="Vertical"   TextBlock.Foreground="{DynamicResource MaterialDesignBody}">

                                                    <Grid>
                                                        <Grid.RowDefinitions >
                                                            <RowDefinition Height="650" />
                                                            <RowDefinition />
                                                            <RowDefinition />
                                                            <RowDefinition />
                                                        </Grid.RowDefinitions>

                                                        <UserControlUC:LocateUC Grid.Row="0" MainImage="{Binding MainImage}"  Height="650"  MatchParam1="{Binding LocateParam1}" MatchParam2="{Binding LocateParam2}" MatchParam3="{Binding LocateParam3}" 
                                                                                 MatchFind="{Binding SampleFind}"   AlignMarkMove="{Binding AlignMarkMove}"  SelectMode="{Binding SelectMode}" OffsetX="{Binding AlignOffsetX}" OffsetY="{Binding AlignOffsetY}" CurrentPosX="{Binding TablePosX }" CurrentPosY="{Binding TablePosY }" />
                                                        <Border Grid.Row="1" BorderBrush="Black" BorderThickness="2" >
                                                            <StackPanel Orientation="Horizontal" >
                                                                <Button Margin="2" Content="Confirm" Command="{Binding ParamConfirmCommand}"  />
                                                                <Button Margin="2" Content="Locate Run" Command="{Binding LocateRunCommand}" IsEnabled="{Binding IsCanWorkEFEMTrans}" />

                                                            </StackPanel>

                                                        </Border>
                                                        <Button Grid.Row="2" Content="WaferToMicro" Command="{Binding EFEMTransToMicroCommand}" CommandParameter="WaferToMacro" IsEnabled="{Binding IsCanWorkEFEMTrans}" Width="150" Height="40" HorizontalAlignment="Left" Margin="5" />
                                                        <Button Grid.Row="3" Grid.Column="2" Content="TEST" FontSize="20" Height="50" Width="200"  Command="{Binding TableTestCommand}" Cursor="Hand" />
                                                    </Grid>


                                                </StackPanel>


                                            </Grid>
                                        </Grid >


                                    </TabItem>

                                    <TabItem Width="190" IsSelected="{Binding IsDetectionPageSelect}" >
                                        <TabItem.Header>
                                            <Grid Margin="-10" Width="190"  >
                                                <Grid.ColumnDefinitions>
                                                    <ColumnDefinition />
                                                    <ColumnDefinition Width="2.5*" />
                                                    <ColumnDefinition />
                                                </Grid.ColumnDefinitions>
                                                <usercontrols:SignalUC Width="20" Height="20"  Margin="-20,0,0,0" IsSignal="{Binding IsDetectionComplete}"  />
                                                <TextBlock Text="Detection" Grid.Column="1" FontSize="22"  Margin="-20,0,0,0" />
                                                <materialDesign:PackIcon Grid.Column="2" Margin="-20,0,0,0"  Width="30"  Height="30"  Kind="ArrowRightBold" />
                                            </Grid>
                                        </TabItem.Header>
                                        <Grid>
                                            <Grid.ColumnDefinitions>
                                                <ColumnDefinition Width="35*"/>
                                                <ColumnDefinition Width="36*"/>
                                            </Grid.ColumnDefinitions>
                                            <Grid.RowDefinitions>
                                                <RowDefinition Height="0.06*"/>
                                                <RowDefinition Height="0.8*"/>
                                                <RowDefinition Height="0.14*"/>
                                            </Grid.RowDefinitions>
                                            <StackPanel Grid.Row="0" Orientation="Horizontal" Grid.ColumnSpan="2"   >
                                                <Button Margin="5" Content="ADD" FontSize="24" Height="50" Width="180"  Command="{Binding AddDetectionCommand}"  />
                                                <Button Margin="5" Content="Remove" FontSize="24" Height="50" Width="180"   Command="{Binding RemoveDetectionCommand}"  />
                                                <Button Margin="5" Content="Edit" FontSize="24" Height="50" Width="180"   Command="{Binding EditDetectionCommand}"  />
                                            </StackPanel>
                                            <StackPanel Grid.Row="1" Grid.ColumnSpan="2">
                                                <Border   Style="{StaticResource HorizontalDividerBorder}" />
                                                <StackPanel  Margin="1"  Orientation="Vertical"  TextBlock.Foreground="{DynamicResource MaterialDesignBody}">
                                                    <DataGrid  Margin="0" ItemsSource="{Binding DetectionPointList}"  CanUserSortColumns="False" 
                                                    AutoGenerateColumns="False" SelectionUnit="FullRow" SelectedIndex="{Binding SelectDetectionPointList}" Height="795"  >
                                                        <i:Interaction.Triggers>
                                                            <i:EventTrigger EventName="PreviewMouseDoubleClick">
                                                                <i:InvokeCommandAction Command="{Binding DetectionPointListDoubleClickCommand}"/>
                                                            </i:EventTrigger>
                                                        </i:Interaction.Triggers>
                                                        <DataGrid.Columns >
                                                            <DataGridTextColumn  Width="70"  Header="Col"  Binding="{Binding IndexX}" IsReadOnly="True"/>
                                                            <DataGridTextColumn  Width="70"  Header="Row"  Binding="{Binding IndexY}" IsReadOnly="True"/>
                                                            <DataGridTextColumn  Width="120"  Header="PosX"  Binding="{Binding Position.X}" IsReadOnly="True"/>
                                                            <DataGridTextColumn  Width="120"  Header="PosY"  Binding="{Binding Position.Y}" IsReadOnly="True"/>
                                                            <DataGridTextColumn  Width="100"  Header="Lens"  Binding="{Binding LensIndex}" IsReadOnly="True"/>
                                                            <DataGridTextColumn  Width="100"  Header="Cube"  Binding="{Binding CubeIndex}" IsReadOnly="True"/>
                                                            <DataGridTextColumn  Width="100"  Header="Filter1"  Binding="{Binding Filter1Index}" IsReadOnly="True"/>
                                                            <DataGridTextColumn  Width="100"  Header="Filter2"  Binding="{Binding Filter2Index}" IsReadOnly="True"/>
                                                            <DataGridTextColumn  Width="100"  Header="Filter3"  Binding="{Binding Filter3Index}" IsReadOnly="True"/>
                                                            <DataGridTextColumn  Width="100"  Header="LightValue"  Binding="{Binding MicroscopeLightValue}" IsReadOnly="True"/>
                                                            <DataGridTextColumn  Width="100"  Header="ApertureValue"  Binding="{Binding MicroscopeApertureValue}" IsReadOnly="True"/>
                                                        </DataGrid.Columns>
                                                    </DataGrid>
                                                </StackPanel>
                                                <Border   Style="{StaticResource HorizontalDividerBorder}" />
                                            </StackPanel>
                                            <GroupBox Grid.Row="2" Header="Die Trans" FontSize="20" Grid.ColumnSpan="2">
                                                <StackPanel Margin="-5" Orientation="Horizontal">
                                                    <!--<Button Margin="5" FontSize="20" Height ="40" Content="TransOnlyDie" Command="{Binding TransOnlyDieCommand}"  />-->
                                                    <!--<Button Margin="5" FontSize="20" Height ="40" Content="TransDieInSideAll" Command="{Binding TransDieInSideAllCommand}"  />-->
                                                    <!--<Button Margin="5" FontSize="20" Height ="40" Content="TransDieSub" Command="{Binding TransDieSubCommand}"  />-->
                                                    <Button Margin="5" Grid.Row="3" Grid.Column="2" Content="TEST" FontSize="20" Height="50" Width="200"  Command="{Binding DetectionTestCommand}" Cursor="Hand" />
                                                    <Button Margin="5" Grid.Row="3" Grid.Column="2" Content="Pause" FontSize="20" Height="50" Width="200"  Command="{Binding DetectionPauseTestCommand}" Cursor="Hand" />
                                                </StackPanel>
                                            </GroupBox>
                                        </Grid>
                                    </TabItem>
                                </TabControl>

                            </Border>


                        </Grid>


                    </Grid>
                    <Grid Grid.Row="1" Grid.Column="0">
                        <Grid.ColumnDefinitions>
                            <ColumnDefinition  Width="1.3*"/>
                            <ColumnDefinition/>
                        </Grid.ColumnDefinitions>
                        <GroupBox  FontSize="16"  Header="Microscope"  >
                            <microscope:BXFMUC  Margin="-5" Microscope="{Binding Microscope}" MicroscopeParam="{Binding MicroscopeParam}" IsEnabled="{Binding IsCanWorkEFEMTrans}"/>
                        </GroupBox>
                        <GroupBox Grid.Column="1"  FontSize="16"  Header="Axis Move"  >
                            <Grid  Grid.Column="1" Grid.Row="1" Margin="-5" IsEnabled="{Binding IsCanWorkEFEMTrans}">
                                <Grid.ColumnDefinitions>
                                    <ColumnDefinition Width="265*"/>
                                    <ColumnDefinition Width="272*"/>
                                </Grid.ColumnDefinitions>
                                <Grid.RowDefinitions>
                                    <RowDefinition Height="0.2*"/>
                                    <RowDefinition Height="0.80*" />
                                </Grid.RowDefinitions>
                                <Border   Grid.Row="0" BorderBrush="Black" BorderThickness="1" Grid.ColumnSpan="2"  >
                                    <StackPanel Orientation="Horizontal"  >
                                        <Label Content="Index" Width="80" FontSize="26" />
                                        <Label Content="Col" Width="70" FontSize="26" />
                                        <TextBox Text="{Binding MoveIndexX}"    FontSize="22"   Width="70" VerticalAlignment="Center" HorizontalAlignment="Center" />
                                        <Label Content="Row" Width="70" FontSize="26" />
                                        <TextBox Text="{Binding MoveIndexY}"   FontSize="26"  Width="70" VerticalAlignment="Center" HorizontalAlignment="Center"/>
                                        <Button Content="Move" Height="50" FontSize="20" VerticalAlignment="Top"   Width="100"  Command="{Binding LocatedMoveDieCommand}" IsEnabled="{Binding IsCanWorkEFEMTrans}" />
                                    </StackPanel>
                                </Border>
                                <Grid Grid.Row="1" Grid.ColumnSpan="2">
                                    <Grid.ColumnDefinitions>
                                        <ColumnDefinition Width="0.35*"/>
                                        <ColumnDefinition Width="0.65*"/>
                                    </Grid.ColumnDefinitions>
                                    <Grid>
                                        <Grid.RowDefinitions >
                                            <RowDefinition />
                                            <RowDefinition />
                                            <RowDefinition />
                                        </Grid.RowDefinitions>
                                        <Button Grid.Column="0" Grid.Row="0" Content="Grab" FontSize="20" Height="50" Width="150"  Command="{Binding GrabCommand}"  />
                                        <Button Grid.Column="0" Grid.Row="1"  Width="60"  Height="60"   >
                                            <materialDesign:PackIcon Margin="-10,0,-10,0" Width="50"  Height="50"  Kind="ArrowUpBold" />
                                            <i:Interaction.Triggers>
                                                <i:EventTrigger EventName="PreviewMouseDown">
                                                    <i:InvokeCommandAction  Command="{Binding TableZContinueMoveCommand}"  CommandParameter="Z-"/>
                                                </i:EventTrigger>
                                                <i:EventTrigger EventName="PreviewMouseUp">
                                                    <i:InvokeCommandAction Command="{Binding TableZMoveCommand}"  CommandParameter="Z-"/>
                                                </i:EventTrigger>
                                            </i:Interaction.Triggers>
                                        </Button>
                                        <Button Grid.Column="1" Grid.Row="2"  Width="60"  Height="60"   >
                                            <materialDesign:PackIcon Margin="-10,0,-10,0" Width="50"  Height="50"  Kind="ArrowDownBold" />
                                            <i:Interaction.Triggers>
                                                <i:EventTrigger EventName="PreviewMouseDown">
                                                    <i:InvokeCommandAction  Command="{Binding TableZContinueMoveCommand}"  CommandParameter="Z+"/>
                                                </i:EventTrigger>
                                                <i:EventTrigger EventName="PreviewMouseUp">
                                                    <i:InvokeCommandAction Command="{Binding TableZMoveCommand}"  CommandParameter="Z+"/>
                                                </i:EventTrigger>
                                            </i:Interaction.Triggers>
                                        </Button>
                                    </Grid>
                                    <UserControlUC:WorkholderUC Grid.Column ="1" TableX="{Binding TableX }" TableY="{Binding TableY }" TablePosX="{Binding TablePosX}" TablePosY="{Binding TablePosY}" HorizontalAlignment="Left" VerticalAlignment="Top" Width="350" Height="200" IsEnabled="{Binding IsCanWorkEFEMTrans}" />
                                </Grid>
                            </Grid>
                        </GroupBox>
                    </Grid>



                </Grid>
            </TabItem>

            <TabItem  Margin="0,0,0,0"  Height="75" Background="White" IsSelected="{Binding IsMainToolsPageSelect}">
                <TabItem.Header>
                    <StackPanel   Width="auto"   Height="auto">
                        <materialDesign:PackIcon  Width="34"   Height="34"  HorizontalAlignment="Center"   Kind="Tools" />
                        <TextBlock  HorizontalAlignment="Center" Text="Tools" />
                    </StackPanel>
                </TabItem.Header>
                <Grid>
                    <Grid.ColumnDefinitions>
                        <ColumnDefinition/>
                        <ColumnDefinition/>
                        <ColumnDefinition/>
                    </Grid.ColumnDefinitions>
                    <GroupBox Grid.Column="0" Header="UnLoadWafer" FontSize="24" Grid.ColumnSpan="2" >
                        <Grid >
                            <Grid.ColumnDefinitions>
                                <ColumnDefinition />
                                <ColumnDefinition />
                            </Grid.ColumnDefinitions>
                            <Grid.RowDefinitions>
                                <RowDefinition Height="2*"/>
                                <RowDefinition/>

                            </Grid.RowDefinitions>
                            <GroupBox Grid.Row="0" materialDesign:ColorZoneAssist.Background="DarkGray"
                                    materialDesign:ColorZoneAssist.Foreground="White"
                                    materialDesign:ColorZoneAssist.Mode="Custom"   FontSize="20"
                                     Header="Robot" Style="{StaticResource MaterialDesignGroupBox}">
                                <Grid Margin="-5">
                                    <Grid.Resources>
                                        <Style x:Key="TextStyle" TargetType="Label">
                                            <Setter Property="FontSize" Value="10" />
                                            <!-- 需要自行參考 Style name  TextStyle -->
                                        </Style>
                                        <Style TargetType="TextBox">
                                            <Setter Property="FontSize" Value="10" />
                                            <!--  預設所有 TextBox -->
                                        </Style>
                                        <Style TargetType="Label">
                                            <Setter Property="FontSize" Value="10" />
                                            <!--  預設所有 TextBox -->
                                        </Style>
                                    </Grid.Resources>
                                    <Grid.ColumnDefinitions >
                                        <ColumnDefinition Width="1.2*" />
                                        <ColumnDefinition />
                                    </Grid.ColumnDefinitions>
                                    <Grid Grid.Column="0">
                                        <Grid.ColumnDefinitions>
                                            <ColumnDefinition Width="0.27*"/>
                                            <ColumnDefinition Width="0.42*" />
                                            <ColumnDefinition Width="0.31*"/>

                                        </Grid.ColumnDefinitions>
                                        <Grid.RowDefinitions>
                                            <RowDefinition Height="46*"/>
                                            <RowDefinition Height="46*"/>
                                            <RowDefinition Height="46*"/>
                                            <RowDefinition Height="47"/>
                                            <RowDefinition Height="47*"/>
                                            <RowDefinition Height="47*"/>
                                            <RowDefinition Height="47*"/>
                                            <RowDefinition Height="47*"/>
                                            <RowDefinition Height="47*"/>
                                            <RowDefinition Height="47*"/>
                                            <RowDefinition Height="46*"/>
                                            <RowDefinition Height="46*"/>
                                            <RowDefinition Height="47*"/>
                                        </Grid.RowDefinitions>

                                        <Border Grid.Row="1" Grid.ColumnSpan="3" Grid.RowSpan="7"  BorderBrush="Teal" BorderThickness="1" >

                                        </Border>
                                        <TextBlock  Text="Axis Settings" Grid.ColumnSpan="3" FontWeight="Bold" Foreground="Teal" />
                                        <Label Grid.Row="1"  Grid.Column="0" Content="Load Port1:"/>
                                        <TextBox Grid.Row="1" IsReadOnly="True"  Text="{Binding RobotAxisLoadPort1TakePosition}"  Grid.Column="1" />
                                        <Button Grid.Row="1"  Grid.Column="2"  Margin="2" Background="Tan" BorderBrush="Tan" Content="Move" Command="{Binding RobotMoveCommand}"  CommandParameter="LoadPort1"/>


                                        <Label Grid.Row="2"  Grid.Column="0" Content="Load Port2:"/>
                                        <TextBox Grid.Row="2" IsReadOnly="True" Text="{Binding RobotAxisLoadPort2TakePosition}"  Grid.Column="1" />
                                        <Button Grid.Row="2"  Grid.Column="2"  Margin="2" Background="Tan" BorderBrush="Tan" Content="Move" Command="{Binding RobotMoveCommand}"  CommandParameter="LoadPort2"/>

                                        <Label Grid.Row="3"  Grid.Column="0" Content="Aligner1:"/>
                                        <TextBox Grid.Row="3" IsReadOnly="True" Text="{Binding RobotAxisAligner1TakePosition}"  Grid.Column="1" />
                                        <Button Grid.Row="3"  Grid.Column="2"  Margin="2" Background="Tan" BorderBrush="Tan" Content="Move" Command="{Binding RobotMoveCommand}"  CommandParameter="Aligner1"/>

                                        <Label Grid.Row="4"  Grid.Column="0" Content="Aligner2:"/>
                                        <TextBox Grid.Row="4" IsReadOnly="True" Text="{Binding RobotAxisAligner2TakePosition}"  Grid.Column="1" />
                                        <Button Grid.Row="4"  Grid.Column="2"  Margin="2" Background="Tan" BorderBrush="Tan" Content="Move" Command="{Binding RobotMoveCommand}"  CommandParameter="Aligner2"/>

                                        <Label Grid.Row="5"  Grid.Column="0" Content="Macro:"/>
                                        <TextBox Grid.Row="5" IsReadOnly="True" Text="{Binding RobotAxisAligner1TakePosition}"  Grid.Column="1" />
                                        <Button Grid.Row="5"  Grid.Column="2"  Margin="2" Background="Tan" BorderBrush="Tan" Content="Move" Command="{Binding RobotMoveCommand}"  CommandParameter="Macro"/>


                                        <Label Grid.Row="6"  Grid.Column="0" Content="Micro:"/>
                                        <TextBox Grid.Row="6" IsReadOnly="True" Text="{Binding RobotAxisMicroTakePosition}"  Grid.Column="1" />
                                        <Button Grid.Row="6"  Grid.Column="2"  Margin="2" Background="Tan" BorderBrush="Tan" Content="Move" Command="{Binding RobotMoveCommand}"  CommandParameter="Micro"/>

                                        <TextBlock  Grid.Row="8" Grid.ColumnSpan="3"  Text="Vacuum" FontWeight="Bold" Foreground="Teal" />
                                        <Border Grid.Row="9" Grid.ColumnSpan="3" Grid.RowSpan="3"  BorderBrush="Teal" BorderThickness="1" >
                                            <Grid>
                                                <Grid.RowDefinitions>
                                                    <RowDefinition/>
                                                    <RowDefinition/>
                                                    <RowDefinition/>

                                                </Grid.RowDefinitions>
                                                <Grid.ColumnDefinitions>
                                                    <ColumnDefinition/>
                                                    <ColumnDefinition/>
                                                    <ColumnDefinition/>
                                                    <ColumnDefinition />
                                                </Grid.ColumnDefinitions>

                                                <Label Grid.Row="0" Content="8 Inch" />
                                                <Label Grid.Row="1" Content="12 Inch" />
                                                <Button Margin="2" Grid.Row="0" Grid.Column="2" Background="CadetBlue" BorderBrush="CadetBlue" Content="On" Command="{Binding VaccumOn}"/>
                                                <Button Margin="2" Grid.Row="0"  Grid.Column="3" Background="CadetBlue" BorderBrush="CadetBlue" Content="Off" Command="{Binding VaccumOff}"/>
                                                <Button Margin="2" Grid.Row="1" Grid.Column="2" Background="CadetBlue" BorderBrush="CadetBlue" Content="On" Command="{Binding VaccumOn}"/>
                                                <Button Margin="2" Grid.Row="1"  Grid.Column="3" Background="CadetBlue" BorderBrush="CadetBlue" Content="Off" Command="{Binding VaccumOff}"/>
                                                <usercontrols:SignalUC Grid.Row="0" Grid.Column="1"   Margin="2" Width="20" Height="20" IsSignal="False" />
                                                <usercontrols:SignalUC Grid.Row="1" Grid.Column="1" Margin="2" Width="20" Height="20" IsSignal="False" />
                                            </Grid>
                                        </Border>


                                    </Grid>

                                    <StackPanel Grid.Column="1">
                                        <Button Margin="3" Height="40" Content="Home" Command="{Binding Home}"/>
                                        <Button Margin="3" Height="40" Background="YellowGreen"  BorderBrush="YellowGreen" Content="Pick Wafer From LoadPort" Command="{Binding PickWaferFromLoadPort}"/>
                                        <Button Margin="3" Height="40" Background="YellowGreen"   BorderBrush="YellowGreen" Content="Pick Wafer From Aligner" Command="{Binding PickWaferFromAligner}"/>
                                        <Button Margin="3" Height="40" Background="YellowGreen"   BorderBrush="YellowGreen" Content="Pick Wafer From Micro" Command="{Binding PickWaferFromMicro}"/>
                                        <Button Margin="3" Height="40" Background="YellowGreen"  BorderBrush="YellowGreen" Content="Pick Wafer From Macro" Command="{Binding PickWaferFromMacro}"/>


                                        <Button Margin="3" Height="40" Foreground="Black"  Background="LightGreen"  BorderBrush="LightGreen" Content="Put Wafer To LoadPort" Command="{Binding PutWaferToLoadPort}"/>
                                        <Button Margin="3" Height="40" Foreground="Black"  Background="LightGreen"  BorderBrush="LightGreen" Content="Put Wafer To Aligner" Command="{Binding PutWaferToAligner}"/>
                                        <Button Margin="3" Height="40" Foreground="Black" Background="LightGreen"  BorderBrush="LightGreen"  Content="Put Wafer To Micro" Command="{Binding PutWaferToMicro}"/>
                                        <Button Margin="3" Height="40" Foreground="Black"  Background="LightGreen"  BorderBrush="LightGreen" Content="Put Wafer To Macro" Command="{Binding PutWaferToMacro}"/>
                                    </StackPanel>
                                </Grid>

                            </GroupBox>
                            <GroupBox Grid.Column="1" Header="Load Port1" Grid.Row="0" materialDesign:ColorZoneAssist.Background="DarkGray"
                                    materialDesign:ColorZoneAssist.Foreground="White"
                                    materialDesign:ColorZoneAssist.Mode="Custom"   FontSize="20"
                                      Style="{StaticResource MaterialDesignGroupBox}"  >
                                <UserControlUC:LoadPortUnitUC Margin="-5" LoadPort="{Binding LoadPort1}" LoadPortWafers="{Binding LoadPort1Wafers}" LoadPortUIShow ="{Binding LoadPortUIShow}" IsLoadPortParamReadOnly="True" />
                            </GroupBox>
                            <Grid Grid.Column="1" Grid.Row="1" >
                                <!--<UserControlUC:MappingCanvasTest />-->
                            </Grid>
                        </Grid>
                    </GroupBox>

                </Grid>
            </TabItem>


            <TabItem  Margin="0,0,0,0" Height="75" Background="White"  IsSelected="{Binding IsMainSettingPageSelect}"  >
                <TabItem.Header>
                    <StackPanel  Width="auto"  Height="auto">
                        <materialDesign:PackIcon    Width="34"   Height="34"   HorizontalAlignment="Center"  Kind="CogOutline" />
                        <TextBlock  HorizontalAlignment="Center"   Text="Settings" />
                    </StackPanel>
                </TabItem.Header>
                <Grid>
                    <Grid.RowDefinitions>
                        <RowDefinition Height="0.75*"/>
                        <RowDefinition Height="0.25*"/>
                    </Grid.RowDefinitions>
                    <Grid.ColumnDefinitions>
                        <ColumnDefinition Width="0.3*"/>
                        <ColumnDefinition Width="0.3*"/>
                        <ColumnDefinition Width="0.4*"/>
                    </Grid.ColumnDefinitions>
                    <GroupBox Grid.Row="0" materialDesign:ColorZoneAssist.Background="DarkGray"
                                    materialDesign:ColorZoneAssist.Foreground="White"
                                    materialDesign:ColorZoneAssist.Mode="Custom"   FontSize="20"
                                     Header="Axis Settings" Style="{StaticResource MaterialDesignGroupBox}">
                        <Grid Margin="-5">
                            <Grid.Resources>
                                <Style x:Key="TextStyle" TargetType="Label">
                                    <Setter Property="FontSize" Value="10" />
                                    <!-- 需要自行參考 Style name  TextStyle -->
                                </Style>
                                <Style TargetType="TextBox">
                                    <Setter Property="FontSize" Value="10" />
                                    <!--  預設所有 TextBox -->
                                </Style>
                                <Style TargetType="Label">
                                    <Setter Property="FontSize" Value="10" />
                                    <!--  預設所有 TextBox -->
                                </Style>
                            </Grid.Resources>
                            <Grid.ColumnDefinitions >
                                <ColumnDefinition Width="0.5*" />
                                <ColumnDefinition Width="0.5*"/>
                            </Grid.ColumnDefinitions>
                            <Grid Grid.Column="0">
                                <Grid.ColumnDefinitions>
                                    <ColumnDefinition Width="0.4*"/>
                                    <ColumnDefinition Width="0.3*"/>
                                    <ColumnDefinition Width="0.3*"/>
                                </Grid.ColumnDefinitions>
                                <Grid.RowDefinitions>
                                    <RowDefinition Height="46*"/>
                                    <RowDefinition Height="46*"/>
                                    <RowDefinition Height="46*"/>
                                    <RowDefinition Height="47"/>
                                    <RowDefinition Height="47*"/>
                                    <RowDefinition Height="47*"/>
                                    <RowDefinition Height="47*"/>
                                    <RowDefinition Height="47*"/>
                                    <RowDefinition Height="47*"/>
                                    <RowDefinition Height="47*"/>
                                    <RowDefinition Height="46*"/>
                                    <RowDefinition Height="46*"/>
                                    <RowDefinition Height="47*"/>
                                </Grid.RowDefinitions>

                                <Border Grid.Row="1" Grid.ColumnSpan="3" Grid.RowSpan="7"  BorderBrush="Teal" BorderThickness="1" >

                                </Border>
                                <TextBlock  Text="Robot Axis" Grid.ColumnSpan="3" FontWeight="Bold" Foreground="Teal" />

                                <Label Grid.Row="1"  Grid.Column="0" FontSize="12" VerticalAlignment="Center" Content="Load Port1:"/>
                                <TextBox Grid.Row="1" Text="{Binding RobotAxisLoadPort1TakePosition}"  Grid.Column="1" />
                                <Button Grid.Row="1"  Grid.Column="2"  Margin="2" Background="Tan" BorderBrush="Tan" Content="Move" Command="{Binding RobotMoveCommand}"  CommandParameter="LoadPort1"/>


                                <Label Grid.Row="2"  Grid.Column="0" FontSize="12" VerticalAlignment="Center" Content="Load Port2:"/>
                                <TextBox Grid.Row="2" Text="{Binding RobotAxisLoadPort2TakePosition}"  Grid.Column="1" />
                                <Button Grid.Row="2"  Grid.Column="2"  Margin="2" Background="Tan" BorderBrush="Tan" Content="Move" Command="{Binding RobotMoveCommand}"  CommandParameter="LoadPort2"/>

                                <Label Grid.Row="3"  Grid.Column="0" FontSize="12" VerticalAlignment="Center" Content="Aligner1:"/>
                                <TextBox Grid.Row="3" Text="{Binding RobotAxisAligner1TakePosition}"  Grid.Column="1" />
                                <Button Grid.Row="3"  Grid.Column="2"  Margin="2" Background="Tan" BorderBrush="Tan" Content="Move" Command="{Binding RobotMoveCommand}"  CommandParameter="Aligner1"/>

                                <Label Grid.Row="4"  Grid.Column="0" FontSize="12" VerticalAlignment="Center" Content="Aligner2:"/>
                                <TextBox Grid.Row="4" Text="{Binding RobotAxisAligner2TakePosition}"  Grid.Column="1" />
                                <Button Grid.Row="4"  Grid.Column="2"  Margin="2" Background="Tan" BorderBrush="Tan" Content="Move" Command="{Binding RobotMoveCommand}"  CommandParameter="Aligner2"/>

                                <Label Grid.Row="5"  Grid.Column="0" FontSize="12" VerticalAlignment="Center" Content="Macro:"/>
                                <TextBox Grid.Row="5" Text="{Binding RobotAxisMacroTakePosition}"  Grid.Column="1" />
                                <Button Grid.Row="5"  Grid.Column="2"  Margin="2" Background="Tan" BorderBrush="Tan" Content="Move" Command="{Binding RobotMoveCommand}"  CommandParameter="Macro"/>


                                <Label Grid.Row="6"  Grid.Column="0" FontSize="12" VerticalAlignment="Center" Content="Micro:"/>
                                <TextBox Grid.Row="6" Text="{Binding RobotAxisMicroTakePosition}"  Grid.Column="1" />
                                <Button Grid.Row="6"  Grid.Column="2"  Margin="2" Background="Tan" BorderBrush="Tan" Content="Move" Command="{Binding RobotMoveCommand}"  CommandParameter="Micro"/>

                                <TextBlock  Grid.Row="8" Grid.ColumnSpan="3"  Text="Micro Vacuum" FontWeight="Bold" Foreground="Teal" />
                                <Border Grid.Row="9" Grid.ColumnSpan="3" Grid.RowSpan="3"  BorderBrush="Teal" BorderThickness="1" >
                                    <Grid>
                                        <Grid.RowDefinitions>
                                            <RowDefinition/>
                                            <RowDefinition/>
                                            <RowDefinition/>

                                        </Grid.RowDefinitions>
                                        <Grid.ColumnDefinitions>
                                            <ColumnDefinition/>
                                            <ColumnDefinition/>
                                            <ColumnDefinition/>
                                            <ColumnDefinition />
                                        </Grid.ColumnDefinitions>

                                        <Label Grid.Row="0" Content="8 Inch" />
                                        <Label Grid.Row="1" Content="12 Inch" />
                                        <Button Margin="2" Grid.Row="0" Grid.Column="2" Background="CadetBlue" BorderBrush="CadetBlue" Content="On" Command="{Binding VaccumOn}"/>
                                        <Button Margin="2" Grid.Row="0"  Grid.Column="3" Background="CadetBlue" BorderBrush="CadetBlue" Content="Off" Command="{Binding VaccumOff}"/>
                                        <Button Margin="2" Grid.Row="1" Grid.Column="2" Background="CadetBlue" BorderBrush="CadetBlue" Content="On" Command="{Binding VaccumOn}"/>
                                        <Button Margin="2" Grid.Row="1"  Grid.Column="3" Background="CadetBlue" BorderBrush="CadetBlue" Content="Off" Command="{Binding VaccumOff}"/>
                                        <usercontrols:SignalUC Grid.Row="0" Grid.Column="1"   Margin="2" Width="20" Height="20" IsSignal="False" />
                                        <usercontrols:SignalUC Grid.Row="1" Grid.Column="1" Margin="2" Width="20" Height="20" IsSignal="False" />
                                    </Grid>
                                </Border>


                            </Grid>

                            <Grid Grid.Column="1">
                                <Grid.ColumnDefinitions>
                                    <ColumnDefinition Width="0.35*"/>
                                    <ColumnDefinition Width="0.35*"/>
                                    <ColumnDefinition Width="0.3*"/>
                                </Grid.ColumnDefinitions>
                                <Grid.RowDefinitions>
                                    <RowDefinition Height="46*"/>
                                    <RowDefinition Height="46*"/>
                                    <RowDefinition Height="46*"/>
                                    <RowDefinition Height="47"/>
                                    <RowDefinition Height="47*"/>
                                    <RowDefinition Height="47*"/>
                                    <RowDefinition Height="47*"/>
                                    <RowDefinition Height="47*"/>
                                    <RowDefinition Height="47*"/>
                                    <RowDefinition Height="47*"/>
                                    <RowDefinition Height="46*"/>
                                    <RowDefinition Height="46*"/>
                                    <RowDefinition Height="47*"/>
                                </Grid.RowDefinitions>

                                <Border Grid.Row="1" Grid.ColumnSpan="3" Grid.RowSpan="7" BorderBrush="Teal" BorderThickness="1" />
                                <TextBlock  Text="Wafer Pick/Put Axis" Grid.ColumnSpan="3" FontWeight="Bold" Foreground="Teal" VerticalAlignment="Top" />

                                <Label Grid.Row="1"  Grid.Column="0" Content="Axis X:" FontSize="15" VerticalAlignment="Center"/>
                                <TextBox Grid.Row="1" Text="{Binding TableWaferCatchPositionX }"  Grid.Column="1" />
                                <Button Grid.Row="1"  Grid.Column="2"  Margin="2" Background="Tan" BorderBrush="Tan" Content="Move" Command="{Binding RobotMoveCommand}"  CommandParameter="LoadPort"/>

                                <Label Grid.Row="2"  Grid.Column="0" Content="Axis Y:" FontSize="15" VerticalAlignment="Center"/>
                                <TextBox Grid.Row="2" Text="{Binding TableWaferCatchPositionY }"  Grid.Column="1" />
                                <Button Grid.Row="2"  Grid.Column="2"  Margin="2" Background="Tan" BorderBrush="Tan" Content="Move" Command="{Binding RobotMoveCommand}"  CommandParameter="LoadPort"/>

                                <Label Grid.Row="3"  Grid.Column="0" Content="Axis Z:" FontSize="15" VerticalAlignment="Center"/>
                                <TextBox Grid.Row="3" Text="{Binding TableWaferCatchPositionZ}"  Grid.Column="1" />
                                <Button Grid.Row="3"  Grid.Column="2"  Margin="2" Background="Tan" BorderBrush="Tan" Content="Move" Command="{Binding RobotMoveCommand}"  CommandParameter="LoadPort"/>

                                <Label Grid.Row="4"  Grid.Column="0" Content="Axis T:" FontSize="15" VerticalAlignment="Center"/>
                                <TextBox Grid.Row="4" Text="{Binding TableWaferCatchPositionR}"  Grid.Column="1" />
                                <Button Grid.Row="4"  Grid.Column="2"  Margin="2" Background="Tan" BorderBrush="Tan" Content="Move" Command="{Binding RobotMoveCommand}"  CommandParameter="LoadPort"/>
                            </Grid>
                        </Grid>

                    </GroupBox>
                    <GroupBox Grid.Row="0" Grid.Column="1" materialDesign:ColorZoneAssist.Background="DarkGray"
                                    materialDesign:ColorZoneAssist.Foreground="White"
                                    materialDesign:ColorZoneAssist.Mode="Custom"   FontSize="20"
                                     Header="Microscope Settings" Style="{StaticResource MaterialDesignGroupBox}" >
                        <Grid Margin="-5">

                            <Grid.ColumnDefinitions>
                                <ColumnDefinition Width="0.2*"/>
                                <ColumnDefinition Width="0.4*"/>
                            </Grid.ColumnDefinitions>
                            <Grid Grid.Column="0">
                                <Grid.ColumnDefinitions>
                                    <ColumnDefinition Width="0.3*"/>
                                    <ColumnDefinition Width="0.7*"/>
                                </Grid.ColumnDefinitions>
                                <Grid.RowDefinitions>
                                    <RowDefinition Height="0.1*"/>
                                    <RowDefinition Height="0.1*"/>
                                    <RowDefinition Height="0.1*"/>
                                    <RowDefinition Height="0.1*"/>
                                    <RowDefinition Height="0.1*"/>
                                    <RowDefinition Height="0.1*"/>
                                    <RowDefinition Height="0.1*"/>
                                    <RowDefinition Height="0.1*"/>
                                    <RowDefinition Height="0.1*"/>
                                    <RowDefinition Height="0.1*"/>
                                    <RowDefinition Height="0.1*"/>
                                    <RowDefinition Height="0.1*"/>
                                    <RowDefinition Height="0.1*"/>
                                </Grid.RowDefinitions>

                                <Border Grid.Row="1" Grid.ColumnSpan="3" Grid.RowSpan="7" BorderBrush="Teal" BorderThickness="1" />
                                <TextBlock  Text="Lens Ratio" Grid.ColumnSpan="3" FontWeight="Bold" Foreground="Teal" VerticalAlignment="Top" />

                                <Label Grid.Row="1"  Grid.Column="0" Content="Lens" FontSize="15" VerticalAlignment="Bottom" />
                                <Label Grid.Row="1"  Grid.Column="1" Content="um/pixal" FontSize="15" VerticalAlignment="Bottom" />

                                <Label Grid.Row="2"  Grid.Column="0" Content="1." FontSize="15" VerticalAlignment="Bottom" />
                                <TextBox Grid.Row="2" Text="{Binding MicroscopeLensDefault[1].Ratio }" VerticalAlignment="Bottom"  Grid.Column="1" />

                                <Label Grid.Row="3"  Grid.Column="0" Content="2." FontSize="15" VerticalAlignment="Bottom" />
                                <TextBox Grid.Row="3" Text="{Binding MicroscopeLensDefault[2].Ratio}" VerticalAlignment="Bottom"  Grid.Column="1" />

                                <Label Grid.Row="4"  Grid.Column="0" Content="3." FontSize="15" VerticalAlignment="Bottom" />
                                <TextBox Grid.Row="4" Text="{Binding MicroscopeLensDefault[3].Ratio}" VerticalAlignment="Bottom"  Grid.Column="1" />

                                <Label Grid.Row="5"  Grid.Column="0" Content="4." FontSize="15" VerticalAlignment="Bottom" />
                                <TextBox Grid.Row="5" Text="{Binding MicroscopeLensDefault[4].Ratio}" VerticalAlignment="Bottom"  Grid.Column="1" />

                                <Label Grid.Row="6"  Grid.Column="0" Content="5." FontSize="15" VerticalAlignment="Bottom" />
                                <TextBox Grid.Row="6" Text="{Binding MicroscopeLensDefault[5].Ratio}" VerticalAlignment="Bottom"  Grid.Column="1" />
                            </Grid>
                            <Grid Grid.Column="1">
                                <Grid.ColumnDefinitions>
                                    <ColumnDefinition Width="0.2*"/>
                                    <ColumnDefinition Width="0.35*"/>
                                    <ColumnDefinition Width="0.1*"/>
                                    <ColumnDefinition Width="0.35*"/>
                                </Grid.ColumnDefinitions>
                                <Grid.RowDefinitions>
                                    <RowDefinition Height="0.1*"/>
                                    <RowDefinition Height="0.1*"/>
                                    <RowDefinition Height="0.1*"/>
                                    <RowDefinition Height="0.1*"/>
                                    <RowDefinition Height="0.1*"/>
                                    <RowDefinition Height="0.1*"/>
                                    <RowDefinition Height="0.1*"/>
                                    <RowDefinition Height="0.1*"/>
                                    <RowDefinition Height="0.1*"/>
                                    <RowDefinition Height="0.1*"/>
                                    <RowDefinition Height="0.1*"/>
                                    <RowDefinition Height="0.1*"/>
                                    <RowDefinition Height="0.1*"/>
                                </Grid.RowDefinitions>

                                <Border Grid.Row="1" Grid.ColumnSpan="4" Grid.RowSpan="7" BorderBrush="Teal" BorderThickness="1" />
                                <TextBlock  Text="AF Default" Grid.ColumnSpan="4" FontWeight="Bold" Foreground="Teal" VerticalAlignment="Top" />



                                <Label Grid.Row="1"  Grid.Column="0" Content="Lens" FontSize="15" VerticalAlignment="Bottom" />
                                <Label Grid.Row="1"  Grid.Column="1" Content="Z Pos" FontSize="15" VerticalAlignment="Bottom" />
                                <Label Grid.Row="1"  Grid.Column="3" Content="Aberation Value" FontSize="15" VerticalAlignment="Bottom"/>

                                <Label Grid.Row="2"  Grid.Column="0" Content="1." FontSize="15" VerticalAlignment="Bottom" HorizontalAlignment="Left" />
                                <TextBox Grid.Row="2" Text="{Binding MicroscopeLensDefault[1].AutoFocusPosition}"  Grid.Column="1"  VerticalAlignment="Bottom" />
                                <TextBox Grid.Row="2" Text="{Binding MicroscopeLensDefault[1].AberationPosition}"  Grid.Column="3" VerticalAlignment="Bottom" />

                                <Label Grid.Row="3"  Grid.Column="0" Content="2." FontSize="15" VerticalAlignment="Bottom" HorizontalAlignment="Left" />
                                <TextBox Grid.Row="3" Text="{Binding MicroscopeLensDefault[2].AutoFocusPosition}"  Grid.Column="1" VerticalAlignment="Bottom"/>
                                <TextBox Grid.Row="3" Text="{Binding MicroscopeLensDefault[2].AberationPosition}"  Grid.Column="3" VerticalAlignment="Bottom" />

                                <Label Grid.Row="4"  Grid.Column="0" Content="3." FontSize="15" VerticalAlignment="Bottom" HorizontalAlignment="Left" />
                                <TextBox Grid.Row="4" Text="{Binding MicroscopeLensDefault[3].AutoFocusPosition}"  Grid.Column="1" VerticalAlignment="Bottom"/>
                                <TextBox Grid.Row="4" Text="{Binding MicroscopeLensDefault[3].AberationPosition}"  Grid.Column="3" VerticalAlignment="Bottom"/>

                                <Label Grid.Row="5"  Grid.Column="0" Content="4." FontSize="15" VerticalAlignment="Bottom" HorizontalAlignment="Left" />
                                <TextBox Grid.Row="5" Text="{Binding MicroscopeLensDefault[4].AutoFocusPosition}"  Grid.Column="1" VerticalAlignment="Bottom"/>
                                <TextBox Grid.Row="5" Text="{Binding MicroscopeLensDefault[4].AberationPosition}"  Grid.Column="3" VerticalAlignment="Bottom"/>

                                <Label Grid.Row="6"  Grid.Column="0" Content="5." FontSize="15" VerticalAlignment="Bottom" HorizontalAlignment="Left" />
                                <TextBox Grid.Row="6" Text="{Binding MicroscopeLensDefault[5].AutoFocusPosition}"  Grid.Column="1" VerticalAlignment="Bottom"/>
                                <TextBox Grid.Row="6" Text="{Binding MicroscopeLensDefault[5].AberationPosition}"  Grid.Column="3" VerticalAlignment="Bottom"/>

                                <Border   Grid.Row="9" Grid.Column ="0" Grid.ColumnSpan="4" Grid.RowSpan="3" BorderBrush="Teal" BorderThickness="1" />
                                <TextBlock Grid.Row="8"  Text="AF Limit" Grid.ColumnSpan="3" FontWeight="Bold" Foreground="Teal" VerticalAlignment="Top" />

                                <Label Grid.Row="9"  Grid.Column="1" Content="Positive Limit" FontSize="15" VerticalAlignment="Bottom" />
                                <Label Grid.Row="9"  Grid.Column="3" Content="Negative Limit" FontSize="15" VerticalAlignment="Bottom"/>

                                <Label Grid.Row="10"  Grid.Column="0" Content="Z:" FontSize="15" VerticalAlignment="Bottom" />
                                <TextBox Grid.Row="10" Text=" "  Grid.Column="1" />
                                <TextBox Grid.Row="10" Text=" "  Grid.Column="3" />
                            </Grid>
                        </Grid>
                    </GroupBox>
                    <GroupBox Grid.Row="0" Grid.Column="2" materialDesign:ColorZoneAssist.Background="DarkGray"
                                    materialDesign:ColorZoneAssist.Foreground="White"
                                    materialDesign:ColorZoneAssist.Mode="Custom"   FontSize="20"
                                     Header="Robot Address Settings" Style="{StaticResource MaterialDesignGroupBox}" >
                        <Grid Margin="-5">
                            <Grid.ColumnDefinitions>
                                <ColumnDefinition Width="0.25*"/>
                                <ColumnDefinition Width="0.25*"/>
                                <ColumnDefinition Width="0.25*"/>
                                <ColumnDefinition Width="0.25*"/>
                                <ColumnDefinition Width="0.25*"/>
                                <ColumnDefinition Width="0.25*"/>
                            </Grid.ColumnDefinitions>
                            <Grid Grid.Column="0">
                                <Grid.ColumnDefinitions>
                                    <ColumnDefinition Width="0.4*"/>
                                    <ColumnDefinition Width="0.6*"/>
                                </Grid.ColumnDefinitions>
                                <Grid.RowDefinitions>
                                    <RowDefinition Height="0.1*"/>
                                    <RowDefinition Height="0.1*"/>
                                    <RowDefinition Height="0.1*"/>
                                    <RowDefinition Height="0.1*"/>
                                    <RowDefinition Height="0.1*"/>
                                    <RowDefinition Height="0.1*"/>
                                    <RowDefinition Height="0.1*"/>
                                    <RowDefinition Height="0.1*"/>
                                    <RowDefinition Height="0.1*"/>
                                    <RowDefinition Height="0.1*"/>
                                    <RowDefinition Height="0.1*"/>
                                    <RowDefinition Height="0.1*"/>
                                    <RowDefinition Height="0.1*"/>
                                    <RowDefinition Height="0.1*"/>
                                </Grid.RowDefinitions>
                                <Border Grid.Row="1" Grid.ColumnSpan="3" Grid.RowSpan="6" BorderBrush="Teal" BorderThickness="1" />
                                <TextBlock  Text="LoadPort1 Pick" Grid.ColumnSpan="3" FontSize="14" FontWeight="Bold" Foreground="Teal" VerticalAlignment="Top" />
                                <Label Grid.Row="1"  Grid.Column="0" Content="Step" FontSize="15" VerticalAlignment="Bottom" />
                                <Label Grid.Row="1"  Grid.Column="1" Content="Address" FontSize="15" VerticalAlignment="Bottom" />

                                <Label Grid.Row="2"  Grid.Column="0" Content="1." FontSize="15" VerticalAlignment="Center" />
                                <TextBox Grid.Row="2" Text="110"  Grid.Column="1" VerticalAlignment="Center"  />

                                <Label Grid.Row="3"  Grid.Column="0" Content="2." FontSize="15" VerticalAlignment="Center" />
                                <TextBox Grid.Row="3" Text="111"  Grid.Column="1" VerticalAlignment="Center" />

                                <Label Grid.Row="4"  Grid.Column="0" Content="3." FontSize="15" VerticalAlignment="Center" />
                                <TextBox Grid.Row="4" Text="111"  Grid.Column="1" VerticalAlignment="Center" />

                                <Label Grid.Row="5"  Grid.Column="0" Content="4." FontSize="15" VerticalAlignment="Center" />
                                <TextBox Grid.Row="5" Text="111"  Grid.Column="1" VerticalAlignment="Center" />

                                <Label Grid.Row="6"  Grid.Column="0" Content="5." FontSize="15" VerticalAlignment="Center" />
                                <TextBox Grid.Row="6" Text="111"  Grid.Column="1" VerticalAlignment="Center" />


                                <Border Grid.Row="8" Grid.ColumnSpan="3" Grid.RowSpan="6" BorderBrush="Teal" BorderThickness="1" />
                                <TextBlock Grid.Row="7"  Text="LoadPort1 Place" Grid.ColumnSpan="3" FontSize="14" FontWeight="Bold" Foreground="Teal" VerticalAlignment="Top" />
                                <Label Grid.Row="8"  Grid.Column="0" Content="Step" FontSize="15" VerticalAlignment="Bottom" />
                                <Label Grid.Row="8"  Grid.Column="1" Content="Address" FontSize="15" VerticalAlignment="Bottom" />

                                <Label Grid.Row="9"  Grid.Column="0" Content="1." FontSize="15" VerticalAlignment="Center" />
                                <TextBox Grid.Row="9" Text="110"  Grid.Column="1" VerticalAlignment="Center" />

                                <Label Grid.Row="10"  Grid.Column="0" Content="2." FontSize="15" VerticalAlignment="Center" />
                                <TextBox Grid.Row="10" Text="111"  Grid.Column="1" VerticalAlignment="Center" />

                                <Label Grid.Row="11"  Grid.Column="0" Content="3." FontSize="15" VerticalAlignment="Center" />
                                <TextBox Grid.Row="11" Text="111"  Grid.Column="1" VerticalAlignment="Center" />

                                <Label Grid.Row="12"  Grid.Column="0" Content="4." FontSize="15" VerticalAlignment="Center" />
                                <TextBox Grid.Row="12" Text="111"  Grid.Column="1" VerticalAlignment="Center" />

                                <Label Grid.Row="13"  Grid.Column="0" Content="5." FontSize="15" VerticalAlignment="Center" />
                                <TextBox Grid.Row="13" Text="111"  Grid.Column="1" VerticalAlignment="Center" />
                            </Grid>
                            <Grid Grid.Column="1">
                                <Grid.ColumnDefinitions>
                                    <ColumnDefinition Width="0.4*"/>
                                    <ColumnDefinition Width="0.6*"/>
                                </Grid.ColumnDefinitions>
                                <Grid.RowDefinitions>
                                    <RowDefinition Height="0.1*"/>
                                    <RowDefinition Height="0.1*"/>
                                    <RowDefinition Height="0.1*"/>
                                    <RowDefinition Height="0.1*"/>
                                    <RowDefinition Height="0.1*"/>
                                    <RowDefinition Height="0.1*"/>
                                    <RowDefinition Height="0.1*"/>
                                    <RowDefinition Height="0.1*"/>
                                    <RowDefinition Height="0.1*"/>
                                    <RowDefinition Height="0.1*"/>
                                    <RowDefinition Height="0.1*"/>
                                    <RowDefinition Height="0.1*"/>
                                    <RowDefinition Height="0.1*"/>
                                    <RowDefinition Height="0.1*"/>

                                </Grid.RowDefinitions>
                                <Border Grid.Row="1" Grid.ColumnSpan="3" Grid.RowSpan="6" BorderBrush="Teal" BorderThickness="1" />
                                <TextBlock  Text="LoadPort2 Pick" Grid.ColumnSpan="3" FontSize="14" FontWeight="Bold" Foreground="Teal" VerticalAlignment="Top" />
                                <Label Grid.Row="1"  Grid.Column="0" Content="Step" FontSize="15" VerticalAlignment="Bottom" />
                                <Label Grid.Row="1"  Grid.Column="1" Content="Address" FontSize="15" VerticalAlignment="Bottom" />

                                <Label Grid.Row="2"  Grid.Column="0" Content="1." FontSize="15" VerticalAlignment="Center" />
                                <TextBox Grid.Row="2" Text="110"  Grid.Column="1" VerticalAlignment="Center"  />

                                <Label Grid.Row="3"  Grid.Column="0" Content="2." FontSize="15" VerticalAlignment="Center" />
                                <TextBox Grid.Row="3" Text="111"  Grid.Column="1" VerticalAlignment="Center" />

                                <Label Grid.Row="4"  Grid.Column="0" Content="3." FontSize="15" VerticalAlignment="Center" />
                                <TextBox Grid.Row="4" Text="111"  Grid.Column="1" VerticalAlignment="Center" />

                                <Label Grid.Row="5"  Grid.Column="0" Content="4." FontSize="15" VerticalAlignment="Center" />
                                <TextBox Grid.Row="5" Text="111"  Grid.Column="1" VerticalAlignment="Center" />

                                <Label Grid.Row="6"  Grid.Column="0" Content="5." FontSize="15" VerticalAlignment="Center" />
                                <TextBox Grid.Row="6" Text="111"  Grid.Column="1" VerticalAlignment="Center" />


                                <Border Grid.Row="8" Grid.ColumnSpan="3" Grid.RowSpan="6" BorderBrush="Teal" BorderThickness="1" />
                                <TextBlock Grid.Row="7"  Text="LoadPort2 Place" Grid.ColumnSpan="3" FontSize="14" FontWeight="Bold" Foreground="Teal" VerticalAlignment="Top" />
                                <Label Grid.Row="8"  Grid.Column="0" Content="Step" FontSize="15" VerticalAlignment="Bottom" />
                                <Label Grid.Row="8"  Grid.Column="1" Content="Address" FontSize="15" VerticalAlignment="Bottom" />

                                <Label Grid.Row="9"  Grid.Column="0" Content="1." FontSize="15" VerticalAlignment="Center" />
                                <TextBox Grid.Row="9" Text="110"  Grid.Column="1" VerticalAlignment="Center" />

                                <Label Grid.Row="10"  Grid.Column="0" Content="2." FontSize="15" VerticalAlignment="Center" />
                                <TextBox Grid.Row="10" Text="111"  Grid.Column="1" VerticalAlignment="Center" />

                                <Label Grid.Row="11"  Grid.Column="0" Content="3." FontSize="15" VerticalAlignment="Center" />
                                <TextBox Grid.Row="11" Text="111"  Grid.Column="1" VerticalAlignment="Center" />

                                <Label Grid.Row="12"  Grid.Column="0" Content="4." FontSize="15" VerticalAlignment="Center" />
                                <TextBox Grid.Row="12" Text="111"  Grid.Column="1" VerticalAlignment="Center" />

                                <Label Grid.Row="13"  Grid.Column="0" Content="5." FontSize="15" VerticalAlignment="Center" />
                                <TextBox Grid.Row="13" Text="111"  Grid.Column="1" VerticalAlignment="Center" />
                            </Grid>
                            <Grid Grid.Column="2">
                                <Grid.RowDefinitions>
                                    <RowDefinition />
                                    <RowDefinition />
                                </Grid.RowDefinitions>
                            </Grid>
                        </Grid>
                    </GroupBox>
                    <Grid Grid.Row="1" Grid.Column="3">
                        <Grid.RowDefinitions>
                            <RowDefinition />
                            <RowDefinition />
                            <RowDefinition />
                            <RowDefinition />
                        </Grid.RowDefinitions>
                        <Grid.ColumnDefinitions>
                            <ColumnDefinition/>
                            <ColumnDefinition/>
                            <ColumnDefinition/>
                        </Grid.ColumnDefinitions>
                        <Button Grid.Row="0" Grid.Column="2" Height="60" Content="Default Bincode" FontSize="26" Command="{Binding DefaultBincodeEditCommand}"     />
                        <Button Grid.Row="2" Grid.Column="2" Height="60" Content="Save" FontSize="30" Command="{Binding SaveSettingCommand}"     />
                    </Grid>

                </Grid>
            </TabItem>

            <TabItem  Margin="0,0,0,0" Height="75" Background="White" IsSelected="{Binding IsMainSecurityPageSelect}"   >
                <TabItem.Header>
                    <StackPanel  Width="auto"  Height="auto">
                        <materialDesign:PackIcon  Margin="0,0,0,0"   Width="34"   Height="34"   HorizontalAlignment="Center"  Kind="Security" />
                        <TextBlock  HorizontalAlignment="Center"   Text="Unit Test" />
                    </StackPanel>
                </TabItem.Header>
                <TabControl >
                    <TabItem >
                        <TabItem.Header>
                            <StackPanel Orientation="Horizontal" >
                                <TextBlock Text="Motion、IO" Grid.Column="1"  Margin="-10,0,0,0" FontSize="22" />
                            </StackPanel>
                        </TabItem.Header>
                        <Grid>
                            <Grid.RowDefinitions>
                                <RowDefinition Height="0.9*"/>
                                <RowDefinition Height="0.1*" />
                            </Grid.RowDefinitions>
                            <Grid>

                                <Grid.ColumnDefinitions>
                                    <ColumnDefinition/>
                                    <ColumnDefinition Width="0.3*"/>
                                </Grid.ColumnDefinitions>
                                <StackPanel>
                                    <motion:AxisMotionUC Axis="{Binding TableX}"  AxisSetConfig="{Binding TableXConfig}"   />
                                    <motion:AxisMotionUC Axis="{Binding TableY}"  AxisSetConfig="{Binding TableYConfig}"/>
                                    <motion:AxisMotionUC Axis="{Binding TableR}"  AxisSetConfig="{Binding TableRConfig}"/>
                                    <motion:AxisMotionUC Axis="{Binding TableZ}"  AxisSetConfig="{Binding TableZConfig}"/>
                                    <motion:AxisMotionUC Axis="{Binding RobotAxis}" AxisSetConfig="{Binding RobotAxisConfig}" />
                                    <Grid Height="480">
                                        <Grid.ColumnDefinitions>
                                            <ColumnDefinition />
                                            <ColumnDefinition />
                                        </Grid.ColumnDefinitions>
                                        <GroupBox Header="Output" Grid.Column="0">
                                            <UserControlUC:DigitalOutputUC Margin="-2" OutputSignals="{Binding DigitalOutputs}"   />
                                        </GroupBox>
                                        <GroupBox Header="Input" Grid.Column="1" >
                                            <UserControlUC:DigitalInputUC Margin="-2" InputSignals="{Binding DigitalInputs}"   />
                                        </GroupBox>
                                    </Grid>
                                </StackPanel>

                            </Grid>
                        </Grid>
                    </TabItem>
                    <TabItem >
                        <TabItem.Header>
                            <StackPanel Orientation="Horizontal" >
                                <TextBlock Text="Microscope" Grid.Column="1"  Margin="-10,0,0,0" FontSize="22" />
                            </StackPanel>
                        </TabItem.Header>
                        <Grid>
                            <Grid.ColumnDefinitions >
                                <ColumnDefinition Width="0.5*"/>
                                <ColumnDefinition Width="0.15*"/>
                                <ColumnDefinition Width="0.15*"/>
                                <ColumnDefinition Width="0.2*"/>
                            </Grid.ColumnDefinitions>
                            <Grid.RowDefinitions >
                                <RowDefinition />
                                <RowDefinition />
                                <RowDefinition />
                            </Grid.RowDefinitions>
                            <GroupBox  FontSize="16"  Header="Microscope" Grid.Column="0" Grid.Row="0">
                                <microscope:BXFMUC  Margin="-5" Microscope="{Binding Microscope}" MicroscopeParam="{Binding MicroscopeParam}"/>
                            </GroupBox>
                            <GroupBox Grid.Column="1" Grid.Row="0" Header="Aberation" FontSize="16">

                                <UserControlUC:AFAberationUnitUC Grid.Column="2"  HorizontalAlignment="Left" VerticalAlignment="Top" />
                            </GroupBox>


                        </Grid>

                    </TabItem>
                    <TabItem >
                        <TabItem.Header>
                            <StackPanel Orientation="Horizontal" >
                                <TextBlock Text="Robot、LoadPort、Aligner" Grid.Column="1"  Margin="-10,0,0,0" FontSize="22" />
                            </StackPanel>
                        </TabItem.Header>
                        <Grid >
                            <Grid.ColumnDefinitions>
                                <ColumnDefinition Width="0.9*" />
                                <ColumnDefinition />
                                <ColumnDefinition />
                            </Grid.ColumnDefinitions>
                            <Grid.RowDefinitions>
                                <RowDefinition Height="150*"/>
                                <RowDefinition Height="300*"/>
                                <RowDefinition Height="200*"/>

                            </Grid.RowDefinitions>
                            <GroupBox Header="Robot" materialDesign:ColorZoneAssist.Background="DarkGray"
                                    materialDesign:ColorZoneAssist.Foreground="White"
                                    materialDesign:ColorZoneAssist.Mode="Custom"   FontSize="20"
                                      Style="{StaticResource MaterialDesignGroupBox}" Grid.RowSpan="2">
                                <UserControlUC:RobotUnitUC Margin="-5" Robot="{Binding Robot}" RobotStaus="{Binding RobotStaus }" />
                            </GroupBox>
                            <GroupBox Grid.Row="2" Grid.Column="0" materialDesign:ColorZoneAssist.Background="DarkGray"
                                    materialDesign:ColorZoneAssist.Foreground="White"
                                    materialDesign:ColorZoneAssist.Mode="Custom"   FontSize="20"
                                     Header="Aligner" Style="{StaticResource MaterialDesignGroupBox}">
                                <UserControlUC:AlignerUnitUC Grid.Column="0" Grid.Row="2" Margin="-5" Aligner="{Binding Aligner}" AlignerUIShow="{Binding AlignerUIShow }"    />
                            </GroupBox>



                            <GroupBox Grid.Column="1" Header="Load Port1" Grid.Row="0" materialDesign:ColorZoneAssist.Background="DarkGray"
                                    materialDesign:ColorZoneAssist.Foreground="White"
                                    materialDesign:ColorZoneAssist.Mode="Custom"   FontSize="20"
                                      Style="{StaticResource MaterialDesignGroupBox}" Grid.RowSpan="2" >
                                <UserControlUC:LoadPortUnitUC Margin="-5" LoadPort="{Binding LoadPort1}" LoadPortWafers="{Binding LoadPort1Wafers}" LoadPortUIShow ="{Binding LoadPortUIShow}" IsLoadPortParamReadOnly="False" />

                            </GroupBox>
                            <GroupBox Grid.Column="2" Header="Load Port2" Grid.Row="0" materialDesign:ColorZoneAssist.Background="DarkGray"
                                    materialDesign:ColorZoneAssist.Foreground="White"
                                    materialDesign:ColorZoneAssist.Mode="Custom"   FontSize="20" IsEnabled="{Binding LoadportQuantity, Converter={StaticResource CvrIsLoadPortEnable}}" 
                                      Style="{StaticResource MaterialDesignGroupBox}" Grid.RowSpan="2" >
                                <UserControlUC:LoadPortUnitUC Margin="-5" LoadPort="{Binding LoadPort2}" LoadPortWafers="{Binding LoadPort2Wafers}" LoadPortUIShow ="{Binding LoadPort2UIShow}" IsLoadPortParamReadOnly="False" />

                            </GroupBox>
                        </Grid>
                    </TabItem>

                </TabControl>

            </TabItem>

        </TabControl>

        <Grid HorizontalAlignment="Left" Margin="0,590,0,10">
            <Grid.RowDefinitions>
                <RowDefinition/>
                <RowDefinition  Height="0.8*" />
                <RowDefinition Height="1.4*"/>
                <RowDefinition  Height="0.8*"/>
                <RowDefinition/>
            </Grid.RowDefinitions>
            <Grid >
                <Button Width="80" Height="80" Background="{DynamicResource MaterialDesignTextFieldBoxBackground}"
                    IsEnabled="{Binding DataContext.ControlsEnabled, RelativeSource={RelativeSource FindAncestor, AncestorType=Window}}"
                    Style="{StaticResource MaterialDesignIconButton}"  Command="{Binding VolumeOffCommand}"  ToolTip="Mute" Foreground="#FF010910">

                    <materialDesign:PackIcon Width="70" Height="70" Kind="VolumeOff"  />
                </Button>
            </Grid>
            <Grid Grid.Row="2" >
                <StackPanel>
                    <materialDesign:PackIcon    Width="44"   Height="44"   HorizontalAlignment="Center"  Kind="AccountLock" />
                    <TextBlock  HorizontalAlignment="Center"   Text="{Binding Account.CurrentAccount.Right}" />
                    <TextBlock  HorizontalAlignment="Center"   Text="{Binding Account.CurrentAccount.Name}" />
                    <account:UserRightsControl Margin="10,0,0,0" Grid.Row="1" Account="{Binding Account}"/>
                </StackPanel>
            </Grid>

            <Grid Grid.Row="4" Height="80" Width="90">
                <Button Width="80" Height="80" IsEnabled="{Binding DataContext.ControlsEnabled, RelativeSource={RelativeSource FindAncestor, AncestorType=Window}}"
                        Style="{StaticResource MaterialDesignIconForegroundButton}"  Command="{Binding ShowInfoCommand}"  ToolTip="Information"  >

                    <materialDesign:PackIcon Width="70" Height="70" Kind="InformationOutline"  />
                </Button>
            </Grid>


        </Grid>

    </Grid>
</metro:MetroWindow>
